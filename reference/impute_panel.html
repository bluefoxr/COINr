<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Impute panel data — impute_panel • COINr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Impute panel data — impute_panel"><meta name="description" content="Given a data frame of panel data, with a time-index column time_col and a unit ID column unit_col, imputes other
columns using the entry from the latest available time point."><meta property="og:description" content="Given a data frame of panel data, with a time-index column time_col and a unit ID column unit_col, imputes other
columns using the entry from the latest available time point."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">COINr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/overview.html">Overview</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/v1.html">v1.0 updates</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-guides"><li><h6 class="dropdown-header" data-toc-skip>Construction</h6></li>
    <li><a class="dropdown-item" href="../articles/coins.html">Building coins</a></li>
    <li><a class="dropdown-item" href="../articles/imputation.html">Imputation of missing data</a></li>
    <li><a class="dropdown-item" href="../articles/denomination.html">Denomination</a></li>
    <li><a class="dropdown-item" href="../articles/screening.html">Unit screening</a></li>
    <li><a class="dropdown-item" href="../articles/treat.html">Outlier treatment</a></li>
    <li><a class="dropdown-item" href="../articles/normalise.html">Normalisation</a></li>
    <li><a class="dropdown-item" href="../articles/weights.html">Weighting</a></li>
    <li><a class="dropdown-item" href="../articles/aggregate.html">Aggregation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Post-processing</h6></li>
    <li><a class="dropdown-item" href="../articles/visualisation.html">Visualisation</a></li>
    <li><a class="dropdown-item" href="../articles/analysis.html">Statistical analysis</a></li>
    <li><a class="dropdown-item" href="../articles/results.html">Presenting results</a></li>
    <li><a class="dropdown-item" href="../articles/adjustments.html">Adjustments and comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity.html">Sensitivity analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other</h6></li>
    <li><a class="dropdown-item" href="../articles/data_selection.html">Data selection</a></li>
    <li><a class="dropdown-item" href="../articles/other_functions.html">Other functions</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/bluefoxr/COINr/"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Impute panel data</h1>
      <small class="dont-index">Source: <a href="https://github.com/bluefoxr/COINr/blob/master/R/impute.R" class="external-link"><code>R/impute.R</code></a></small>
      <div class="d-none name"><code>impute_panel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a data frame of panel data, with a time-index column <code>time_col</code> and a unit ID column <code>unit_col</code>, imputes other
columns using the entry from the latest available time point.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">impute_panel</span><span class="op">(</span></span>
<span>  <span class="va">iData</span>,</span>
<span>  time_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unit_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  imp_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_time <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-idata">iData<a class="anchor" aria-label="anchor" href="#arg-idata"></a></dt>
<dd><p>A data frame of indicator data, containing a time index column <code>time_col</code>, a unit code column <code>unit_col</code>,
and other numerical columns to be imputed.</p></dd>


<dt id="arg-time-col">time_col<a class="anchor" aria-label="anchor" href="#arg-time-col"></a></dt>
<dd><p>The name of a column found in <code>iData</code> to be used as the time index column. Must point to a numeric column.</p></dd>


<dt id="arg-unit-col">unit_col<a class="anchor" aria-label="anchor" href="#arg-unit-col"></a></dt>
<dd><p>The name of a column found in <code>iData</code> to be used as the unit code/ID column. Must point to a character column.</p></dd>


<dt id="arg-cols">cols<a class="anchor" aria-label="anchor" href="#arg-cols"></a></dt>
<dd><p>Optionally, a character vector of names of columns to impute. If <code>NULL</code> (default), all columns apart from <code>time_col</code> and
<code>unit_col</code> will be imputed where possible.</p></dd>


<dt id="arg-imp-type">imp_type<a class="anchor" aria-label="anchor" href="#arg-imp-type"></a></dt>
<dd><p>One of <code>"latest"</code> <code>"constant"</code>, <code>"linear"</code> or <code>"linear-constant"</code>. In the first case, missing points are imputed with the last non-<code>NA</code> observation for each
time series, up to <code>max_time</code>. For <code>"constant"</code> or <code>"linear"</code>, missing points are imputed using <code><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">stats::approx()</a></code>, passing  <code>"constant"</code> or <code>"linear"</code> to the
<code>method</code> argument, and points outside of the range of observed values are replaced with the nearest non-<code>NA</code> point.
This is equivalent to <code>rule = 2</code> in <code><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">stats::approx()</a></code> for each time series. The difference between <code>"latest"</code> and <code>"constant"</code> is that
the latter allows control over the maximum number of time points to impute backwards (using <code>max_time</code>) whereas the former
doesn't. Additionally, <code>"constant"</code> will impute outside of the observed range of values at the beginning of the time series, whereas <code>"latest"</code> won't. Finally, the <code>"linear-constant"</code>
option will apply linear imputation where possible, but will revert to the "constant" method for any time series with only one observation,
which would otherwise throw an error for "linear".</p></dd>


<dt id="arg-max-time">max_time<a class="anchor" aria-label="anchor" href="#arg-max-time"></a></dt>
<dd><p>The maximum number of time points to look backwards to impute from. E.g. if <code>max_time = 1</code>, if an
<code>NA</code> is found at time \(t\), it will only look for a replacement value at \(t-1\) but not in any time points before that.
By default, searches all time points available.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><ul><li><p><code>.$iData_imp</code>: An <code>iData</code> format data frame with missing data imputed using previous time points (where possible).</p></li>
<li><p><code>.$DataT</code>: A data frame in the same format as <code>iData</code>, where each entry shows which time point each data point
came from.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This presumes that there are multiple observations for each unit code, i.e. one per time point. It then searches for any missing values in the target year, and replaces them with the equivalent points
from previous time points. It will replace using the most recently available point or using linear interpolation: see <code>imp_type</code> argument.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Copy example panel data</span></span></span>
<span class="r-in"><span><span class="va">iData_p</span> <span class="op">&lt;-</span> <span class="va">ASEM_iData_p</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we introduce two NAs: one for NZ in 2022 in LPI indicator</span></span></span>
<span class="r-in"><span><span class="va">iData_p</span><span class="op">$</span><span class="va">LPI</span><span class="op">[</span><span class="va">iData_p</span><span class="op">$</span><span class="va">uCode</span> <span class="op">==</span> <span class="st">"NZ"</span> <span class="op">&amp;</span> <span class="va">iData_p</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">2022</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="co"># one for AT, also in 2022, but for Flights indicator</span></span></span>
<span class="r-in"><span><span class="va">iData_p</span><span class="op">$</span><span class="va">Flights</span><span class="op">[</span><span class="va">iData_p</span><span class="op">$</span><span class="va">uCode</span> <span class="op">==</span> <span class="st">"AT"</span> <span class="op">&amp;</span> <span class="va">iData_p</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">2022</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># impute: target only the two columns where NAs introduced</span></span></span>
<span class="r-in"><span><span class="va">l_imp</span> <span class="op">&lt;-</span> <span class="fu">impute_panel</span><span class="op">(</span><span class="va">iData_p</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LPI"</span>, <span class="st">"Flights"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># get imputed df</span></span></span>
<span class="r-in"><span><span class="va">iData_imp</span> <span class="op">&lt;-</span> <span class="va">l_imp</span><span class="op">$</span><span class="va">iData_imp</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check the output is what we expect: both NAs introduced should now have 2021 values</span></span></span>
<span class="r-in"><span><span class="va">iData_imp</span><span class="op">$</span><span class="va">LPI</span><span class="op">[</span><span class="va">iData_imp</span><span class="op">$</span><span class="va">uCode</span> <span class="op">==</span> <span class="st">"NZ"</span> <span class="op">&amp;</span> <span class="va">iData_imp</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">2022</span><span class="op">]</span> <span class="op">==</span></span></span>
<span class="r-in"><span>  <span class="va">ASEM_iData_p</span><span class="op">$</span><span class="va">LPI</span><span class="op">[</span><span class="va">ASEM_iData_p</span><span class="op">$</span><span class="va">uCode</span> <span class="op">==</span> <span class="st">"NZ"</span> <span class="op">&amp;</span> <span class="va">ASEM_iData_p</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">2021</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logical(0)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">iData_imp</span><span class="op">$</span><span class="va">Flights</span><span class="op">[</span><span class="va">iData_imp</span><span class="op">$</span><span class="va">uCode</span> <span class="op">==</span> <span class="st">"AT"</span> <span class="op">&amp;</span> <span class="va">iData_imp</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">2022</span><span class="op">]</span> <span class="op">==</span></span></span>
<span class="r-in"><span>  <span class="va">ASEM_iData_p</span><span class="op">$</span><span class="va">Flights</span><span class="op">[</span><span class="va">ASEM_iData_p</span><span class="op">$</span><span class="va">uCode</span> <span class="op">==</span> <span class="st">"AT"</span> <span class="op">&amp;</span> <span class="va">ASEM_iData_p</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">2021</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logical(0)</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://www.willbecker.me" class="external-link">William Becker</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

