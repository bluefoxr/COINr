<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Static heatmaps of correlation matrices — plot_corr • COINr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Static heatmaps of correlation matrices — plot_corr"><meta name="description" content="Generates heatmaps of correlation matrices using ggplot2, which can be tailored according to the grouping and structure
of the index. This enables correlating any set of indicators against any other,
and supports calling named aggregation groups of indicators. The withparent argument generates tables of correlations only with
parents of each indicator. Also supports discrete colour maps using flagcolours, different types of correlation, and groups
plots by higher aggregation levels."><meta property="og:description" content="Generates heatmaps of correlation matrices using ggplot2, which can be tailored according to the grouping and structure
of the index. This enables correlating any set of indicators against any other,
and supports calling named aggregation groups of indicators. The withparent argument generates tables of correlations only with
parents of each indicator. Also supports discrete colour maps using flagcolours, different types of correlation, and groups
plots by higher aggregation levels."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">COINr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/overview.html">Overview</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/v1.html">v1.0 updates</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-guides"><li><h6 class="dropdown-header" data-toc-skip>Construction</h6></li>
    <li><a class="dropdown-item" href="../articles/coins.html">Building coins</a></li>
    <li><a class="dropdown-item" href="../articles/imputation.html">Imputation of missing data</a></li>
    <li><a class="dropdown-item" href="../articles/denomination.html">Denomination</a></li>
    <li><a class="dropdown-item" href="../articles/screening.html">Unit screening</a></li>
    <li><a class="dropdown-item" href="../articles/treat.html">Outlier treatment</a></li>
    <li><a class="dropdown-item" href="../articles/normalise.html">Normalisation</a></li>
    <li><a class="dropdown-item" href="../articles/weights.html">Weighting</a></li>
    <li><a class="dropdown-item" href="../articles/aggregate.html">Aggregation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Post-processing</h6></li>
    <li><a class="dropdown-item" href="../articles/visualisation.html">Visualisation</a></li>
    <li><a class="dropdown-item" href="../articles/analysis.html">Statistical analysis</a></li>
    <li><a class="dropdown-item" href="../articles/results.html">Presenting results</a></li>
    <li><a class="dropdown-item" href="../articles/adjustments.html">Adjustments and comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity.html">Sensitivity analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other</h6></li>
    <li><a class="dropdown-item" href="../articles/data_selection.html">Data selection</a></li>
    <li><a class="dropdown-item" href="../articles/other_functions.html">Other functions</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/bluefoxr/COINr/"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Static heatmaps of correlation matrices</h1>
      <small class="dont-index">Source: <a href="https://github.com/bluefoxr/COINr/blob/master/R/plot_corr.R" class="external-link"><code>R/plot_corr.R</code></a></small>
      <div class="d-none name"><code>plot_corr.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates heatmaps of correlation matrices using ggplot2, which can be tailored according to the grouping and structure
of the index. This enables correlating any set of indicators against any other,
and supports calling named aggregation groups of indicators. The <code>withparent</code> argument generates tables of correlations only with
parents of each indicator. Also supports discrete colour maps using <code>flagcolours</code>, different types of correlation, and groups
plots by higher aggregation levels.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_corr</span><span class="op">(</span></span>
<span>  <span class="va">coin</span>,</span>
<span>  <span class="va">dset</span>,</span>
<span>  iCodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Levels <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  cortype <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  withparent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  grouplev <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  box_level <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  showvals <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  flagcolours <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  flagthresh <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pval <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  insig_colour <span class="op">=</span> <span class="st">"#F0F0F0"</span>,</span>
<span>  text_colour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  discrete_colours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  box_colour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  order_as <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_directions <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-coin">coin<a class="anchor" aria-label="anchor" href="#arg-coin"></a></dt>
<dd><p>The coin object</p></dd>


<dt id="arg-dset">dset<a class="anchor" aria-label="anchor" href="#arg-dset"></a></dt>
<dd><p>The target data set.</p></dd>


<dt id="arg-icodes">iCodes<a class="anchor" aria-label="anchor" href="#arg-icodes"></a></dt>
<dd><p>An optional list of character vectors where the first entry specifies the indicator/aggregate
codes to correlate against the second entry (also a specification of indicator/aggregate codes)</p></dd>


<dt id="arg-levels">Levels<a class="anchor" aria-label="anchor" href="#arg-levels"></a></dt>
<dd><p>The aggregation levels to take the two groups of indicators from. See <code><a href="get_data.html">get_data()</a></code> for details.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Optional further arguments to pass to <code><a href="get_data.html">get_data()</a></code>.</p></dd>


<dt id="arg-cortype">cortype<a class="anchor" aria-label="anchor" href="#arg-cortype"></a></dt>
<dd><p>The type of correlation to calculate, either <code>"pearson"</code>, <code>"spearman"</code>, or <code>"kendall"</code> (see <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">stats::cor()</a></code>).</p></dd>


<dt id="arg-withparent">withparent<a class="anchor" aria-label="anchor" href="#arg-withparent"></a></dt>
<dd><p>If <code>aglev[1] != aglev[2]</code>, and equal <code>TRUE</code> will only plot correlations of each row with its parent.
If <code>"family"</code>, plots the lowest aggregation level in <code>Levels</code> against all its parent levels.
If <code>FALSE</code> plots the full correlation matrix (default).</p></dd>


<dt id="arg-grouplev">grouplev<a class="anchor" aria-label="anchor" href="#arg-grouplev"></a></dt>
<dd><p>The aggregation level to group correlations by if <code>aglev[1] == aglev[2]</code>. By default, groups correlations into the
aggregation level above. Set to 0 to disable grouping and plot the full matrix.</p></dd>


<dt id="arg-box-level">box_level<a class="anchor" aria-label="anchor" href="#arg-box-level"></a></dt>
<dd><p>The aggregation level to draw boxes around if <code>aglev[1] == aglev[2]</code>.</p></dd>


<dt id="arg-showvals">showvals<a class="anchor" aria-label="anchor" href="#arg-showvals"></a></dt>
<dd><p>If <code>TRUE</code>, shows correlation values. If <code>FALSE</code>, no values shown.</p></dd>


<dt id="arg-flagcolours">flagcolours<a class="anchor" aria-label="anchor" href="#arg-flagcolours"></a></dt>
<dd><p>If <code>TRUE</code>, uses discrete colour map with thresholds defined by <code>flagthresh</code>. If <code>FALSE</code> uses continuous colour map.</p></dd>


<dt id="arg-flagthresh">flagthresh<a class="anchor" aria-label="anchor" href="#arg-flagthresh"></a></dt>
<dd><p>A 3-length vector of thresholds for highlighting correlations, if <code>flagcolours = TRUE</code>.
<code>flagthresh[1]</code> is the negative threshold (default -0.4). Below this value, values will be flagged red.
<code>flagthresh[2]</code> is the "weak" threshold (default 0.3). Values between <code>flagthresh[1]</code> and <code>flagthresh[2]</code> are coloured grey.
<code>flagthresh[3]</code> is the "high" threshold (default 0.9). Anything between <code>flagthresh[2]</code> and <code>flagthresh[3]</code> is flagged "OK",
and anything above <code>flagthresh[3]</code> is flagged "high".</p></dd>


<dt id="arg-pval">pval<a class="anchor" aria-label="anchor" href="#arg-pval"></a></dt>
<dd><p>The significance level for plotting correlations. Correlations with \(p &lt; pval\) will be shown,
otherwise they will be plotted as the colour specified by <code>insig_colour</code>. Set to 0 to disable this.</p></dd>


<dt id="arg-insig-colour">insig_colour<a class="anchor" aria-label="anchor" href="#arg-insig-colour"></a></dt>
<dd><p>The colour to plot insignificant correlations. Defaults to a light grey.</p></dd>


<dt id="arg-text-colour">text_colour<a class="anchor" aria-label="anchor" href="#arg-text-colour"></a></dt>
<dd><p>The colour of the correlation value text (default white).</p></dd>


<dt id="arg-discrete-colours">discrete_colours<a class="anchor" aria-label="anchor" href="#arg-discrete-colours"></a></dt>
<dd><p>An optional 4-length character vector of colour codes or names to define the discrete
colour map if <code>flagcolours = TRUE</code> (from high to low correlation categories). Defaults to a green/blue/grey/purple.</p></dd>


<dt id="arg-box-colour">box_colour<a class="anchor" aria-label="anchor" href="#arg-box-colour"></a></dt>
<dd><p>The line colour of grouping boxes, default black.</p></dd>


<dt id="arg-order-as">order_as<a class="anchor" aria-label="anchor" href="#arg-order-as"></a></dt>
<dd><p>Optional list for ordering the plotting of variables. If specified, this must be a list of length 2, where each entry of the list is
a character vector of the iCodes plotted on the x and y axes of the plot. The plot will then follow the order of these character vectors. Note this must
be used with care because the <code>grouplev</code> and <code>boxlev</code> arguments will not follow the reordering. Hence this argument is probably best used for plots
with no grouping, or for simply re-ordering within groups.</p></dd>


<dt id="arg-use-directions">use_directions<a class="anchor" aria-label="anchor" href="#arg-use-directions"></a></dt>
<dd><p>Logical: if <code>TRUE</code> the extracted data is adjusted using directions found inside the coin (i.e. the "Direction"
column input in <code>iMeta</code>: any indicators with negative direction will have their values multiplied by -1 which will reverse the
direction of correlation). This should only be set to <code>TRUE</code> if the data set has <em>not</em> yet been normalised. For example, this can be
useful to set to <code>TRUE</code> to analyse correlations in the raw data, but would make no sense to analyse correlations in the normalised
data because that already has the direction adjusted! So you would reverse direction twice. In other words, use this at your
discretion.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A plot object generated with ggplot2, which can be edited further with ggplot2 commands.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function calls <code><a href="get_corr.html">get_corr()</a></code>.</p>
<p>Note that this function can only call correlations within the same data set (i.e. only one data set in <code>.$Data</code>).</p>
<p>This function uses ggplot2 to generate plots, so the plot can be further manipulated using ggplot2 commands.
See <code><a href="../articles/visualisation.html">vignette("visualisation")</a></code> for more details on plotting.</p>
<p>This function replaces the now-defunct <code>plotCorr()</code> from COINr &lt; v1.0.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># build example coin</span></span></span>
<span class="r-in"><span><span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="build_example_coin.html">build_example_coin</a></span><span class="op">(</span>up_to <span class="op">=</span> <span class="st">"Normalise"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot correlations between indicators in Sust group, using Normalised dset</span></span></span>
<span class="r-in"><span><span class="fu">plot_corr</span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Normalised"</span>, iCodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Sust"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          grouplev <span class="op">=</span> <span class="fl">2</span>, flagcolours <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_corr-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://www.willbecker.me" class="external-link">William Becker</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

