<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="COINr">
<title>Analysis • COINr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis">
<meta property="og:description" content="COINr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">COINr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/v1.html">v1.0 updates</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-guides">Guides</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-guides">
    <h6 class="dropdown-header" data-toc-skip>Construction</h6>
    <a class="dropdown-item" href="../articles/coins.html">Building coins</a>
    <a class="dropdown-item" href="../articles/imputation.html">Imputation of missing data</a>
    <a class="dropdown-item" href="../articles/denomination.html">Denomination</a>
    <a class="dropdown-item" href="../articles/screening.html">Unit screening</a>
    <a class="dropdown-item" href="../articles/treat.html">Outlier treatment</a>
    <a class="dropdown-item" href="../articles/normalise.html">Normalisation</a>
    <a class="dropdown-item" href="../articles/weights.html">Weighting</a>
    <a class="dropdown-item" href="../articles/aggregate.html">Aggregation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Post-processing</h6>
    <a class="dropdown-item" href="../articles/visualisation.html">Visualisation</a>
    <a class="dropdown-item" href="../articles/analysis.html">Statistical analysis</a>
    <a class="dropdown-item" href="../articles/results.html">Presenting results</a>
    <a class="dropdown-item" href="../articles/adjustments.html">Adjustments and comparisons</a>
    <a class="dropdown-item" href="../articles/sensitivity.html">Sensitivity analysis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Other</h6>
    <a class="dropdown-item" href="../articles/data_selection.html">Data selection</a>
    <a class="dropdown-item" href="../articles/other_functions.html">Other functions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bluefoxr/COINr/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bluefoxr/COINr/blob/HEAD/vignettes/analysis.Rmd" class="external-link"><code>vignettes/analysis.Rmd</code></a></small>
      <div class="d-none name"><code>analysis.Rmd</code></div>
    </div>

    
    
<p>This vignette describes the “analysis” features of COINr. By this, we
mean functions that retrieve statistical measures from the coin in
various ways. This excludes things like sensitivity analysis, which
involves tinkering with the construction methodology.</p>
<p>In short, here we discuss obtaining indicator statistics,
correlations, data availability, and some slightly more complex ideas
such as Cronbach’s alpha and principal component analysis.</p>
<div class="section level2">
<h2 id="indicator-statistics">Indicator statistics<a class="anchor" aria-label="anchor" href="#indicator-statistics"></a>
</h2>
<p>Indicator statistics can be obtained using the
<code><a href="../reference/get_stats.html">get_stats()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load COINr</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bluefoxr.github.io/COINr/">COINr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># build example coin</span></span>
<span><span class="va">coin</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/build_example_coin.html">build_example_coin</a></span><span class="op">(</span>up_to <span class="op">=</span> <span class="st">"new_coin"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get table of indicator statistics for raw data set</span></span>
<span><span class="va">stat_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_stats.html">get_stats</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, out2 <span class="op">=</span> <span class="st">"df"</span><span class="op">)</span></span></code></pre></div>
<p>The resulting data frame has 18 columns, which is hard to display
concisely here. Therefore we will look at the columns in groups of
five.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stat_table</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;     iCode  Min    Max  Mean Median</span></span>
<span><span class="co">#&gt; 1     LPI 2.07   4.23  3.41   3.42</span></span>
<span><span class="co">#&gt; 2 Flights 0.99 211.00 38.60  25.60</span></span>
<span><span class="co">#&gt; 3    Ship 0.00  21.20 12.00  12.70</span></span>
<span><span class="co">#&gt; 4    Bord 0.00 122.00 23.60  18.00</span></span>
<span><span class="co">#&gt; 5    Elec 0.00 110.00 16.20   6.91</span></span></code></pre></div>
<p>Each row is one of the indicators from the targeted data set. Then
columns are statistics, here obvious things like the minimum, maximum,
mean and median.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stat_table</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Std   Skew   Kurt N.Avail N.NonZero</span></span>
<span><span class="co">#&gt; 1  0.538 -0.304 -0.657      51        51</span></span>
<span><span class="co">#&gt; 2 46.700  2.100  4.510      51        51</span></span>
<span><span class="co">#&gt; 3  6.840 -0.576 -0.681      51        42</span></span>
<span><span class="co">#&gt; 4 24.800  2.150  5.790      51        45</span></span>
<span><span class="co">#&gt; 5 22.700  2.230  5.790      51        47</span></span></code></pre></div>
<p>In the first three columns here we find the standard deviation,
skewness and kurtosis. The remaining two columns are “N.Avail”, which is
the number of non-<code>NA</code> data points, and “N.NonZero”, the
number of non-zero points. This latter can be of interest because some
indicators may have a high proportion of zeroes, which can be
problematic.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stat_table</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   N.Unique Frc.Avail Frc.NonZero Frc.Unique Flag.Avail</span></span>
<span><span class="co">#&gt; 1       51         1       1.000      1.000         ok</span></span>
<span><span class="co">#&gt; 2       51         1       1.000      1.000         ok</span></span>
<span><span class="co">#&gt; 3       43         1       0.824      0.843         ok</span></span>
<span><span class="co">#&gt; 4       30         1       0.882      0.588         ok</span></span>
<span><span class="co">#&gt; 5       46         1       0.922      0.902         ok</span></span></code></pre></div>
<p>Here we have “N.Unique”, which is the number of unique data points
(i.e. excluding duplicate values). The following three columns are
similar to previous columns, e.g. “Frc.Avail” is the fraction of data
availability, as opposed to the number of available points (N.Avail).
The final column, “Flag.Avail”, is a logical flag: if the data
availability (“Frc.Avail”) is below the limit specified by the
<code>t_avail</code> argument of <code><a href="../reference/get_stats.html">get_stats()</a></code>, it will be
flagged as “LOW”.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stat_table</span><span class="op">[</span><span class="fl">16</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">stat_table</span><span class="op">)</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Flag.NonZero Flag.Unique Flag.SkewKurt</span></span>
<span><span class="co">#&gt; 1           ok          ok            ok</span></span>
<span><span class="co">#&gt; 2           ok          ok           OUT</span></span>
<span><span class="co">#&gt; 3           ok          ok            ok</span></span>
<span><span class="co">#&gt; 4           ok          ok           OUT</span></span>
<span><span class="co">#&gt; 5           ok          ok           OUT</span></span></code></pre></div>
<p>The first two final columns are analogous to “Flag.Avail” and have
thresholds which are controlled by arguments to
<code><a href="../reference/get_stats.html">get_stats()</a></code>. The final column is a basic test of outliers
which is commonly used in composite indicators, for example in the <a href="https://knowledge4policy.ec.europa.eu/composite-indicators/coin-tool_en" class="external-link">COIN
Tool</a>. This is the same process as used in
<code><a href="../reference/check_SkewKurt.html">check_SkewKurt()</a></code> which will flag “OUT” if the absolute
skewness is greater than a set threshold (default 2) AND kurtosis is
greater than a threshold (default 3.5). In short, indicators that are
flagged here could be considered for outlier treatment.</p>
</div>
<div class="section level2">
<h2 id="unit-data-availability">Unit data availability<a class="anchor" aria-label="anchor" href="#unit-data-availability"></a>
</h2>
<p>The same kind of analysis can be performed for units, rather than
indicators. Here, the main thing of interest is data availability, which
can be obtained throug the <code><a href="../reference/get_data_avail.html">get_data_avail()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_data_avail.html">get_data_avail</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, out2 <span class="op">=</span> <span class="st">"list"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">l_dat</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ Summary:'data.frame': 51 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;  $ ByGroup:'data.frame': 51 obs. of  12 variables:</span></span></code></pre></div>
<p>Here we see the output is a list with two data frames. The first is a
summary for each unit:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">l_dat</span><span class="op">$</span><span class="va">Summary</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;    uCode N_missing N_zero N_miss_or_zero Dat_Avail  Non_Zero</span></span>
<span><span class="co">#&gt; 31   AUS         0      3              3  1.000000 0.9387755</span></span>
<span><span class="co">#&gt; 1    AUT         0      2              2  1.000000 0.9591837</span></span>
<span><span class="co">#&gt; 2    BEL         0      2              2  1.000000 0.9591837</span></span>
<span><span class="co">#&gt; 32   BGD         6      1              7  0.877551 0.9767442</span></span>
<span><span class="co">#&gt; 3    BGR         0      0              0  1.000000 1.0000000</span></span></code></pre></div>
<p>Each unit has its number of missing points, zero points,
missing-or-zero points, as well as the percentage data availability and
percentage non-zero. The “ByGroup” data frame gives data availability
within aggregation groups:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">l_dat</span><span class="op">$</span><span class="va">ByGroup</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;    uCode ConEcFin    Instit  P2P Physical</span></span>
<span><span class="co">#&gt; 31   AUS        1 1.0000000 1.00    1.000</span></span>
<span><span class="co">#&gt; 1    AUT        1 1.0000000 1.00    1.000</span></span>
<span><span class="co">#&gt; 2    BEL        1 1.0000000 1.00    1.000</span></span>
<span><span class="co">#&gt; 32   BGD        1 0.8333333 0.75    0.875</span></span>
<span><span class="co">#&gt; 3    BGR        1 1.0000000 1.00    1.000</span></span></code></pre></div>
<p>Here we just view the first few columns to save space. The values are
the fraction of indicator availability within each aggregation
group.</p>
</div>
<div class="section level2">
<h2 id="correlations">Correlations<a class="anchor" aria-label="anchor" href="#correlations"></a>
</h2>
<p>Correlations can be obtained and viewed directly using the
<code><a href="../reference/plot_corr.html">plot_corr()</a></code> function which is explained in the <a href="visualisation.html">Visualisation</a> vignette. Here, we explore
the functions for obtaining correlation matrices, flags and
p-values.</p>
<p>The most general-purpose function for obtaining correlations between
indicators is <code><a href="../reference/get_corr.html">get_corr()</a></code> function (which is called by
<code><a href="../reference/plot_corr.html">plot_corr()</a></code>). This allows almost any set of
indicators/aggregates to be correlated against almost any other set. We
won’t go over the full functionality here because this is covered in <a href="visualisation.html">Visualisation</a> vignette. However to
demonstrate a couple of examples we begin by building the full example
coin up to the aggregated data set.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_example_coin.html">build_example_coin</a></span><span class="op">(</span>quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Now we can take some examples. First, to get the correlations between
indicators within the Environmental group:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get correlations</span></span>
<span><span class="va">cmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_corr.html">get_corr</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, iCodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Environ"</span><span class="op">)</span>, Levels <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># examine first few rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cmat</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Var1   Var2 Correlation</span></span>
<span><span class="co">#&gt; 1      CO2    CO2   1.0000000</span></span>
<span><span class="co">#&gt; 2   Forest    CO2          NA</span></span>
<span><span class="co">#&gt; 3   MatCon    CO2   0.7222051</span></span>
<span><span class="co">#&gt; 4 PrimEner    CO2   0.3268484</span></span>
<span><span class="co">#&gt; 5    Renew    CO2  -0.5986338</span></span>
<span><span class="co">#&gt; 6      CO2 Forest          NA</span></span></code></pre></div>
<p>Here we see that the default output of <code><a href="../reference/get_corr.html">get_corr()</a></code> is a
long-format correlation table. If you want the wide format, set
<code>make_long = FALSE</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get correlations</span></span>
<span><span class="va">cmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_corr.html">get_corr</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, iCodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Environ"</span><span class="op">)</span>, Levels <span class="op">=</span> <span class="fl">1</span>, make_long <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># examine first few rows</span></span>
<span><span class="fu"><a href="../reference/round_df.html">round_df</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cmat</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;     CO2 Forest MatCon PrimEner Renew</span></span>
<span><span class="co">#&gt; 1  1.00     NA   0.72     0.33 -0.60</span></span>
<span><span class="co">#&gt; 2    NA   1.00     NA       NA  0.35</span></span>
<span><span class="co">#&gt; 3  0.72     NA   1.00     0.38 -0.42</span></span>
<span><span class="co">#&gt; 4  0.33     NA   0.38     1.00    NA</span></span>
<span><span class="co">#&gt; 5 -0.60   0.35  -0.42       NA  1.00</span></span></code></pre></div>
<p>This gives the more classical-looking correlation matrix, although
the long format can sometimes be easier to work with for futher
processing. One further option that is worth mentioning is
<code>pval</code>: by default, <code><a href="../reference/get_corr.html">get_corr()</a></code> will return any
correlations with a p-value lower than 0.05 as <code>NA</code>,
indicating that these correlations are insignificant at this
significance level. You can adjust this threshold by changing
<code>pval</code>, or disable it completely by setting
<code>pval = 0</code>.</p>
<p>On the subject of p-values, COINr includes a <code><a href="../reference/get_pvals.html">get_pvals()</a></code>
function which can be used to get p-values of correlations between a
supplied matrix or data frame. This cannot be used directly on a coin
and is more of a helper function but may still be useful.</p>
<p>Two further functions are of interest regarding correlations. The
first is <code><a href="../reference/get_corr_flags.html">get_corr_flags()</a></code>. This is a useful function for
finding correlations between indicators that exceed or fall below a
given threshold, within aggregation groups:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_corr_flags.html">get_corr_flags</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Normalised"</span>, cor_thresh <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>               thresh_type <span class="op">=</span> <span class="st">"high"</span>, grouplev <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Group      Ind1      Ind2  Corr</span></span>
<span><span class="co">#&gt; 250  Social       CPI FreePress 0.761</span></span>
<span><span class="co">#&gt; 283  Social       CPI      NGOs 0.768</span></span>
<span><span class="co">#&gt; 772  Social FreePress       CPI 0.761</span></span>
<span><span class="co">#&gt; 1250 Social      NGOs       CPI 0.768</span></span></code></pre></div>
<p>Here we have identified any correlations above 0.75, from the
“Normalised” data set, that are between indicators in the same group in
level 2. Actually 0.75 is quite low for searching for “high
correlations”, but it is used as an example here because the example
data set doesn’t have any very high correlations.</p>
<p>By switching <code>thresh_type = "low"</code> we can similarly look
for low/negative correlations:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_corr_flags.html">get_corr_flags</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Normalised"</span>, cor_thresh <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>               thresh_type <span class="op">=</span> <span class="st">"low"</span>, grouplev <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Group      Ind1      Ind2   Corr</span></span>
<span><span class="co">#&gt; 162  Instit CostImpEx      TBTs -0.697</span></span>
<span><span class="co">#&gt; 1778 Instit      RTAs      TBTs -0.752</span></span>
<span><span class="co">#&gt; 2011 Instit      TBTs      RTAs -0.752</span></span>
<span><span class="co">#&gt; 2019 Instit      TBTs    TIRcon -0.623</span></span>
<span><span class="co">#&gt; 2022 Instit      TBTs CostImpEx -0.697</span></span>
<span><span class="co">#&gt; 2120 Instit    TIRcon      TBTs -0.623</span></span></code></pre></div>
<p>Our example has some fairly significant negative correlations! All
within the “Institutional” group, and with the Technical Barriers to
Trade indicator.</p>
<p>A final function to mention is <code><a href="../reference/get_denom_corr.html">get_denom_corr()</a></code>. This is
related to the operation of denominating indicators (see <a href="denomination.html">Denomination</a> vignette), and identifies any
indicators that are correlated (using the absolute value of correlation)
above a given threshold with any of the supplied denominators. This can
help to identify in some cases <em>whether</em> to denominate an
indicator and <em>with what</em> - i.e. if an indicator is strongly
related with a denominator that means it is dependent on it, which may
be a reason to denominate.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_denom_corr.html">get_denom_corr</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, cor_thresh <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Ind  Denom Corr</span></span>
<span><span class="co">#&gt; 70  CultGood Energy 0.71</span></span>
<span><span class="co">#&gt; 119 CultGood    GDP 0.85</span></span>
<span><span class="co">#&gt; 52       FDI Energy 0.74</span></span>
<span><span class="co">#&gt; 101      FDI    GDP 0.85</span></span>
<span><span class="co">#&gt; 99     Goods    GDP 0.80</span></span>
<span><span class="co">#&gt; 102   PRemit    GDP 0.71</span></span>
<span><span class="co">#&gt; 116 Research    GDP 0.78</span></span>
<span><span class="co">#&gt; 100 Services    GDP 0.77</span></span>
<span><span class="co">#&gt; 66     StMob Energy 0.73</span></span>
<span><span class="co">#&gt; 115    StMob    GDP 0.84</span></span></code></pre></div>
<p>Using a threshold of 0.7, and examining the raw data set, we see that
several indicators are strongly related to the denominators, a classical
example being export value of goods (Goods) being well correlated with
GDP. Many of these pairs flagged here are indeed used as denominators in
the ASEM example, but also for conceptual reasons.</p>
</div>
<div class="section level2">
<h2 id="multivariate-tools">Multivariate tools<a class="anchor" aria-label="anchor" href="#multivariate-tools"></a>
</h2>
<p>A first simple tool is to calculate Cronbach’s alpha. This can be
done with any group of indicators, either the full set, or else
targeting specific groups.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_cronbach.html">get_cronbach</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, iCodes <span class="op">=</span> <span class="st">"P2P"</span>, Level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.05126659</span></span></code></pre></div>
<p>This simply calculates Cronbach’s alpha (a measure of statistical
consistency) for the “P2P” group (People to People connectivity, this
case).</p>
<p>Another multivariate analysis tool is principal component analysis
(PCA). Although, like correlation, this is built into base R, the
<code><a href="../reference/get_PCA.html">get_PCA()</a></code> function makes it easier to obtain PCA for groups
of indicators, following the structure of the index.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_PCA.html">get_PCA</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, iCodes <span class="op">=</span> <span class="st">"Sust"</span>, out2 <span class="op">=</span> <span class="st">"list"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in PCAwts(parents[ii]): 1 missing values found. Removing 1 rows with missing values in order to perform</span></span>
<span><span class="co">#&gt; PCA. You can also try imputing data first to avoid this.</span></span>
<span><span class="co">#&gt; Warning in PCAwts(parents[ii]): 22 missing values found. Removing 14 rows with missing values in order to perform</span></span>
<span><span class="co">#&gt; PCA. You can also try imputing data first to avoid this.</span></span>
<span><span class="co">#&gt; Warning in PCAwts(parents[ii]): 8 missing values found. Removing 7 rows with missing values in order to perform</span></span>
<span><span class="co">#&gt; PCA. You can also try imputing data first to avoid this.</span></span></code></pre></div>
<p>The function can return its results either as a list, or appended to
the coin if <code>out2 = "coin"</code>. Here the output is a list and we
will explore its output. First note the warnings above due to missing
data, which can be suppressed using <code>nowarnings = TRUE</code>. The
output list looks like this:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">l_pca</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ Weights   :'data.frame':  60 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ PCAresults:List of 3</span></span></code></pre></div>
<p>I.e. we have a data frame of “PCA weights” and some PCA results. We
ignore the weights for the moment and look closer at the PCA
results:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">l_pca</span><span class="op">$</span><span class="va">PCAresults</span>, max.level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ Environ :List of 3</span></span>
<span><span class="co">#&gt;   ..$ wts   : num [1:5] -0.581 0.214 -0.543 -0.313 0.473</span></span>
<span><span class="co">#&gt;   ..$ PCAres:List of 5</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "class")= chr "prcomp"</span></span>
<span><span class="co">#&gt;   ..$ iCodes: chr [1:5] "CO2" "Forest" "MatCon" "PrimEner" ...</span></span>
<span><span class="co">#&gt;  $ Social  :List of 3</span></span>
<span><span class="co">#&gt;   ..$ wts   : num [1:9] -0.417 -0.324 0.401 -0.191 0.302 ...</span></span>
<span><span class="co">#&gt;   ..$ PCAres:List of 5</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "class")= chr "prcomp"</span></span>
<span><span class="co">#&gt;   ..$ iCodes: chr [1:9] "CPI" "FemLab" "FreePress" "NGOs" ...</span></span>
<span><span class="co">#&gt;  $ SusEcFin:List of 3</span></span>
<span><span class="co">#&gt;   ..$ wts   : num [1:5] 0.472 0.451 -0.492 -0.227 -0.53</span></span>
<span><span class="co">#&gt;   ..$ PCAres:List of 5</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "class")= chr "prcomp"</span></span>
<span><span class="co">#&gt;   ..$ iCodes: chr [1:5] "GDPGrow" "NEET" "PrivDebt" "PubDebt" ...</span></span></code></pre></div>
<p>By default, <code><a href="../reference/get_PCA.html">get_PCA()</a></code> will run a separate PCA for each
aggregation group within the specified level. In this case, it has run
three: one for each of the “Environ”, “Social” and “SusEcFin” groups.
Each of these contains <code>wts</code>, a set of PCA weights for that
group, <code>PCAres</code>, which is the direct output of
<code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">stats::prcomp()</a></code>, and <code>iCodes</code>, which is the
corresponding vector of indicator codes for the group.</p>
<p>We can do some basic PCA analysis using base R’s tools using the
“PCAres” objects, e.g.:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># summarise PCA results for "Social" group</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">l_pca</span><span class="op">$</span><span class="va">PCAresults</span><span class="op">$</span><span class="va">Social</span><span class="op">$</span><span class="va">PCAres</span><span class="op">)</span></span>
<span><span class="co">#&gt; Importance of components:</span></span>
<span><span class="co">#&gt;                           PC1    PC2    PC3     PC4     PC5     PC6     PC7</span></span>
<span><span class="co">#&gt; Standard deviation     2.2042 1.1256 0.9788 0.78834 0.77153 0.56836 0.42463</span></span>
<span><span class="co">#&gt; Proportion of Variance 0.5398 0.1408 0.1065 0.06905 0.06614 0.03589 0.02003</span></span>
<span><span class="co">#&gt; Cumulative Proportion  0.5398 0.6806 0.7871 0.85611 0.92225 0.95814 0.97817</span></span>
<span><span class="co">#&gt;                            PC8     PC9</span></span>
<span><span class="co">#&gt; Standard deviation     0.36068 0.25760</span></span>
<span><span class="co">#&gt; Proportion of Variance 0.01445 0.00737</span></span>
<span><span class="co">#&gt; Cumulative Proportion  0.99263 1.00000</span></span></code></pre></div>
<p>See <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">stats::prcomp()</a></code> and elsewhere for more resources on
PCA in R.</p>
<p>Now turning to the weighting, <code><a href="../reference/get_PCA.html">get_PCA()</a></code> also outputs a
set of “PCA weights”. These are output attached to the list as shown
above, or if <code>out2 = "coin"</code>, will be written to the weights
list inside the coin if <code>weights_to</code> is also specified. See
the <a href="weights.html">Weights</a> vignette for some more details on
this. Note that PCA weights come with a number of caveats: please read
the documentation for <code><a href="../reference/get_PCA.html">get_PCA()</a></code> for a discussion on
this.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by William Becker.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
