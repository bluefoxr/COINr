<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="COINr">
<title>Unit Screening • COINr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Unit Screening">
<meta property="og:description" content="COINr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">COINr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/v1.html">v1.0 updates</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-guides">Guides</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-guides">
    <h6 class="dropdown-header" data-toc-skip>Construction</h6>
    <a class="dropdown-item" href="../articles/coins.html">Building coins</a>
    <a class="dropdown-item" href="../articles/imputation.html">Imputation of missing data</a>
    <a class="dropdown-item" href="../articles/denomination.html">Denomination</a>
    <a class="dropdown-item" href="../articles/screening.html">Unit screening</a>
    <a class="dropdown-item" href="../articles/treat.html">Outlier treatment</a>
    <a class="dropdown-item" href="../articles/normalise.html">Normalisation</a>
    <a class="dropdown-item" href="../articles/weights.html">Weighting</a>
    <a class="dropdown-item" href="../articles/aggregate.html">Aggregation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Post-processing</h6>
    <a class="dropdown-item" href="../articles/visualisation.html">Visualisation</a>
    <a class="dropdown-item" href="../articles/analysis.html">Statistical analysis</a>
    <a class="dropdown-item" href="../articles/results.html">Presenting results</a>
    <a class="dropdown-item" href="../articles/adjustments.html">Adjustments and comparisons</a>
    <a class="dropdown-item" href="../articles/sensitivity.html">Sensitivity analysis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Other</h6>
    <a class="dropdown-item" href="../articles/data_selection.html">Data selection</a>
    <a class="dropdown-item" href="../articles/other_functions.html">Other functions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bluefoxr/COINr/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Unit Screening</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bluefoxr/COINr/blob/HEAD/vignettes/screening.Rmd" class="external-link"><code>vignettes/screening.Rmd</code></a></small>
      <div class="d-none name"><code>screening.Rmd</code></div>
    </div>

    
    
<p>Unit screening is a screening or filtering of units based on data
availability rules. Just like with indicators (columns), when a unit
(row) has very few data points available, it may make sense to remove
it. This avoids drawing conclusions on units with very few data points.
It will also increase the percentage data availability of each indicator
once the units have been removed.</p>
<p>The COINr function <code><a href="../reference/Screen.html">Screen()</a></code> is a generic function with
methods for data frames, coins and purses. It is a <em>building</em>
function in that it creates a new data set in <code>$.Data</code> as its
output.</p>
<div class="section level2">
<h2 id="data-frames">Data frames<a class="anchor" aria-label="anchor" href="#data-frames"></a>
</h2>
<p>We begin with data frames. Let’s take a subset of the inbuilt example
data for demonstration. I cherry-pick some rows and columns which have
some missing values.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bluefoxr.github.io/COINr/">COINr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># example data</span></span>
<span><span class="va">iData</span> <span class="op">&lt;-</span> <span class="va">ASEM_iData</span><span class="op">[</span><span class="fl">40</span><span class="op">:</span><span class="fl">51</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"uCode"</span>, <span class="st">"Research"</span>, <span class="st">"Pat"</span>, <span class="st">"CultServ"</span>, <span class="st">"CultGood"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">iData</span></span>
<span><span class="co">#&gt;    uCode Research   Pat CultServ CultGood</span></span>
<span><span class="co">#&gt; 40   KOR    20437 249.8  1.79800       NA</span></span>
<span><span class="co">#&gt; 41   LAO      175    NA       NA       NA</span></span>
<span><span class="co">#&gt; 42   MYS     8080  64.2  1.15292    7.555</span></span>
<span><span class="co">#&gt; 43   MNG      293   0.3  0.00266    0.046</span></span>
<span><span class="co">#&gt; 44   MMR      299    NA  0.08905       NA</span></span>
<span><span class="co">#&gt; 45   NZL     7731  46.5  0.34615    1.213</span></span>
<span><span class="co">#&gt; 46   PAK     7122   7.2  0.03553    1.256</span></span>
<span><span class="co">#&gt; 47   PHL     1361  11.3  0.29555    3.185</span></span>
<span><span class="co">#&gt; 48   RUS    16182 141.5  1.44633    8.379</span></span>
<span><span class="co">#&gt; 49   SGP    11411 270.5  0.92780   14.507</span></span>
<span><span class="co">#&gt; 50   THA     5317  53.6  0.08969    6.661</span></span>
<span><span class="co">#&gt; 51   VNM     3618    NA       NA       NA</span></span></code></pre></div>
<p>The data has four indicators, plus an identifier column “uCode”.
Looking at each unit, the data availability is variable. We have 12
units in total.</p>
<p>Now let’s use <code><a href="../reference/Screen.html">Screen()</a></code> to screen out some of these
units. Specifically, we will remove any units that have less than 75%
data availabilty (3 of 4 indicators with non-<code>NA</code>
values):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_scr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Screen.html">Screen</a></span><span class="op">(</span><span class="va">iData</span>, unit_screen <span class="op">=</span> <span class="st">"byNA"</span>, dat_thresh <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></code></pre></div>
<p>The output of <code><a href="../reference/Screen.html">Screen()</a></code> is a list:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">l_scr</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ ScreenedData:'data.frame':    9 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;  $ DataSummary :'data.frame':    12 obs. of  10 variables:</span></span>
<span><span class="co">#&gt;  $ RemovedUnits: chr [1:3] "LAO" "MMR" "VNM"</span></span></code></pre></div>
<p>We can see already that the “RemovedUnits” entry tells us that three
units were removed based on our specifications. We now have our new
screened data set:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_scr</span><span class="op">$</span><span class="va">ScreenedData</span></span>
<span><span class="co">#&gt;    uCode Research   Pat CultServ CultGood</span></span>
<span><span class="co">#&gt; 40   KOR    20437 249.8  1.79800       NA</span></span>
<span><span class="co">#&gt; 42   MYS     8080  64.2  1.15292    7.555</span></span>
<span><span class="co">#&gt; 43   MNG      293   0.3  0.00266    0.046</span></span>
<span><span class="co">#&gt; 45   NZL     7731  46.5  0.34615    1.213</span></span>
<span><span class="co">#&gt; 46   PAK     7122   7.2  0.03553    1.256</span></span>
<span><span class="co">#&gt; 47   PHL     1361  11.3  0.29555    3.185</span></span>
<span><span class="co">#&gt; 48   RUS    16182 141.5  1.44633    8.379</span></span>
<span><span class="co">#&gt; 49   SGP    11411 270.5  0.92780   14.507</span></span>
<span><span class="co">#&gt; 50   THA     5317  53.6  0.08969    6.661</span></span></code></pre></div>
<p>And we have a summary of data availability and some other things:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">l_scr</span><span class="op">$</span><span class="va">DataSummary</span><span class="op">)</span></span>
<span><span class="co">#&gt;    uCode N_missing N_zero N_miss_or_zero Dat_Avail Non_Zero LowData LowNonZero</span></span>
<span><span class="co">#&gt; 40   KOR         1      0              1      0.75        1   FALSE      FALSE</span></span>
<span><span class="co">#&gt; 41   LAO         3      0              3      0.25        1    TRUE      FALSE</span></span>
<span><span class="co">#&gt; 42   MYS         0      0              0      1.00        1   FALSE      FALSE</span></span>
<span><span class="co">#&gt; 43   MNG         0      0              0      1.00        1   FALSE      FALSE</span></span>
<span><span class="co">#&gt; 44   MMR         2      0              2      0.50        1    TRUE      FALSE</span></span>
<span><span class="co">#&gt; 45   NZL         0      0              0      1.00        1   FALSE      FALSE</span></span>
<span><span class="co">#&gt;    LowDatOrZeroFlag Included</span></span>
<span><span class="co">#&gt; 40            FALSE     TRUE</span></span>
<span><span class="co">#&gt; 41             TRUE    FALSE</span></span>
<span><span class="co">#&gt; 42            FALSE     TRUE</span></span>
<span><span class="co">#&gt; 43            FALSE     TRUE</span></span>
<span><span class="co">#&gt; 44             TRUE    FALSE</span></span>
<span><span class="co">#&gt; 45            FALSE     TRUE</span></span></code></pre></div>
<p>This table is in fact generated by <code><a href="../reference/get_data_avail.html">get_data_avail()</a></code> -
some more details can be found in the <a href="analysis.html">Analysis</a> vignette.</p>
<p>Other than data availability, units can also be screened based on the
presence of zeros, or on both - this is specified by the
<code>unit_screen</code> argument. Use the <code>Force</code><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Luke. Sorry.&lt;/p&gt;"><sup>1</sup></a> argument
to override the screening rules for specified units if required (either
to force inclusion or force exclusion).</p>
</div>
<div class="section level2">
<h2 id="coins">Coins<a class="anchor" aria-label="anchor" href="#coins"></a>
</h2>
<p>Screening on coins is very similar to data frames, because the coin
method extracts the relevant data set, passes it to the data frame
method, and then then puts the output back as a new data set. This means
the arguments are almost the same. The only thing different is to
specify which data set to screen, the name to give the new data set, and
whether to output a coin or a list.</p>
<p>We’ll build the example coin, then screen the raw data set with a
threshold of 85% data availability and also name the new data set
something different rather than “Screened” (the default):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># build example coin</span></span>
<span><span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_example_coin.html">build_example_coin</a></span><span class="op">(</span>up_to <span class="op">=</span> <span class="st">"new_coin"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># screen units from raw dset</span></span>
<span><span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Screen.html">Screen</a></span><span class="op">(</span><span class="va">coin</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, unit_screen <span class="op">=</span> <span class="st">"byNA"</span>, dat_thresh <span class="op">=</span> <span class="fl">0.85</span>, write_to <span class="op">=</span> <span class="st">"Filtered_85pc"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Written data set to .$Data$Filtered_85pc</span></span>
<span></span>
<span><span class="co"># some details about the coin by calling its print method</span></span>
<span><span class="va">coin</span></span>
<span><span class="co">#&gt; --------------</span></span>
<span><span class="co">#&gt; A coin with...</span></span>
<span><span class="co">#&gt; --------------</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt;   Units: 51 (AUS, AUT, BEL, ...)</span></span>
<span><span class="co">#&gt;   Indicators: 49 (Goods, Services, FDI, ...)</span></span>
<span><span class="co">#&gt;   Denominators: 4 (Area, Energy, GDP, ...)</span></span>
<span><span class="co">#&gt;   Groups: 4 (GDP_group, GDPpc_group, Pop_group, ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Structure:</span></span>
<span><span class="co">#&gt;   Level 1 Indicator: 49 indicators (FDI, ForPort, Goods, ...) </span></span>
<span><span class="co">#&gt;   Level 2 Pillar: 8 groups (ConEcFin, Instit, P2P, ...) </span></span>
<span><span class="co">#&gt;   Level 3 Sub-index: 2 groups (Conn, Sust) </span></span>
<span><span class="co">#&gt;   Level 4 Index: 1 groups (Index) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data sets:</span></span>
<span><span class="co">#&gt;   Raw (51 units)</span></span>
<span><span class="co">#&gt;   Filtered_85pc (48 units)</span></span></code></pre></div>
<p>The printed summary shows that the new data set only has 48 units,
compared to the raw data set with 51. We can find which units were
filtered because this is stored in the coin’s “Analysis” sub-list:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coin</span><span class="op">$</span><span class="va">Analysis</span><span class="op">$</span><span class="va">Filtered_85pc</span><span class="op">$</span><span class="va">RemovedUnits</span></span>
<span><span class="co">#&gt; [1] "BRN" "LAO" "MMR"</span></span></code></pre></div>
<p>The Analysis sub-list also contains the data availability table that
is output by <code><a href="../reference/Screen.html">Screen()</a></code>. As with the data frame method, we
can also choose to screen units by presence of zeroes, or a combination
of zeroes and missing values.</p>
</div>
<div class="section level2">
<h2 id="purses">Purses<a class="anchor" aria-label="anchor" href="#purses"></a>
</h2>
<p>For completion we also demonstrate the purse method. Like most purse
methods, this is simply applying the coin method to each coin in the
purse, without any special features. Here, we perform the same example
as in the coin section, but on a purse of coins:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># build example purse</span></span>
<span><span class="va">purse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_example_purse.html">build_example_purse</a></span><span class="op">(</span>up_to <span class="op">=</span> <span class="st">"new_coin"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># screen units in all coins to 85% data availability</span></span>
<span><span class="va">purse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Screen.html">Screen</a></span><span class="op">(</span><span class="va">purse</span>, dset <span class="op">=</span> <span class="st">"Raw"</span>, unit_screen <span class="op">=</span> <span class="st">"byNA"</span>,</span>
<span>                dat_thresh <span class="op">=</span> <span class="fl">0.85</span>, write_to <span class="op">=</span> <span class="st">"Filtered_85pc"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Written data set to .$Data$Filtered_85pc</span></span>
<span><span class="co">#&gt; Written data set to .$Data$Filtered_85pc</span></span>
<span><span class="co">#&gt; Written data set to .$Data$Filtered_85pc</span></span>
<span><span class="co">#&gt; Written data set to .$Data$Filtered_85pc</span></span>
<span><span class="co">#&gt; Written data set to .$Data$Filtered_85pc</span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="http://www.willbecker.me" class="external-link">William Becker</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
