<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="COINr">
<title>Building coins • COINr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Building coins">
<meta property="og:description" content="COINr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">COINr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.11</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/v1.html">v1.0 updates</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-guides">Guides</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-guides">
    <h6 class="dropdown-header" data-toc-skip>Construction</h6>
    <a class="dropdown-item" href="../articles/coins.html">Building coins</a>
    <a class="dropdown-item" href="../articles/imputation.html">Imputation of missing data</a>
    <a class="dropdown-item" href="../articles/denomination.html">Denomination</a>
    <a class="dropdown-item" href="../articles/screening.html">Unit screening</a>
    <a class="dropdown-item" href="../articles/treat.html">Outlier treatment</a>
    <a class="dropdown-item" href="../articles/normalise.html">Normalisation</a>
    <a class="dropdown-item" href="../articles/weights.html">Weighting</a>
    <a class="dropdown-item" href="../articles/aggregate.html">Aggregation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Post-processing</h6>
    <a class="dropdown-item" href="../articles/visualisation.html">Visualisation</a>
    <a class="dropdown-item" href="../articles/analysis.html">Statistical analysis</a>
    <a class="dropdown-item" href="../articles/results.html">Presenting results</a>
    <a class="dropdown-item" href="../articles/adjustments.html">Adjustments and comparisons</a>
    <a class="dropdown-item" href="../articles/sensitivity.html">Sensitivity analysis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Other</h6>
    <a class="dropdown-item" href="../articles/data_selection.html">Data selection</a>
    <a class="dropdown-item" href="../articles/other_functions.html">Other functions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bluefoxr/COINr/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Building coins</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bluefoxr/COINr/blob/HEAD/vignettes/coins.Rmd" class="external-link"><code>vignettes/coins.Rmd</code></a></small>
      <div class="d-none name"><code>coins.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bluefoxr.github.io/COINr/">COINr</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette gives a guide to building “coins”, which are the object
class representing a composite indicator used throughout COINr, and
“purses”, which are time-indexed collections of coins.</p>
<div class="section level2">
<h2 id="what-is-a-coin">What is a coin?<a class="anchor" aria-label="anchor" href="#what-is-a-coin"></a>
</h2>
<p>COINr functions are designed to work in particular on an S3 object
class called a “coin”. To introduce this, consider what constitutes a
composite indicator:</p>
<ul>
<li>The indicator data</li>
<li>Indicator metadata, including weights and directions</li>
<li>A structure which maps indicators into groups for aggregation,
typically over multiple levels</li>
<li>Methodological specifications, including
<ul>
<li>Data treatment</li>
<li>Normalisation method and parameters</li>
<li>Aggregation method and parameters</li>
</ul>
</li>
<li>Processed data sets at each stage of the construction</li>
<li>Resulting aggregated scores and ranks</li>
</ul>
<p>Meanwhile, in the process of building a composite indicator, a series
of analysis data is generated, including information on data
availability, statistics on individual indicators, correlations and
information about data treatment.</p>
<p>If a composite indicator is built from scratch, it is easy to
generate an environment with dozens of variables and parameters. In case
an alternative version of the composite indicator is built, multiple
sets of variables may need to be generated. With this in mind, it makes
sense to structure all the ingredients of composite indicator, from
input data, to methodology and results, into a single object, which is
called a “coin” in COINr.</p>
<p>How to construct a coin, and some details of its contents, will be
explained in more detail in the following sections. Although coins are
the main object class used in COINr, a number of COINr functions also
have methods for data frames and vectors. This is explained in other
vignettes.</p>
</div>
<div class="section level2">
<h2 id="building-coins">Building coins<a class="anchor" aria-label="anchor" href="#building-coins"></a>
</h2>
<p>To build a coin you need to use the <code><a href="../reference/new_coin.html">new_coin()</a></code> function.
The main two input arguments of this function are two data frames:
<code>iData</code> (the indicator data), and <code>iMeta</code> (the
indicator metadata). This builds a coin class object containing the raw
data, which can then be developed and expanded by COINr functions by
e.g. normalising, treating data, imputing, aggregating and so on.</p>
<p>Before proceeding, we have to define a couple of things. The “things”
that are being benchmarked/compared by the indicators and composite
indicator are more generally referred to as <em>units</em> (quite often,
units correspond to countries). Units are compared using
<em>indicators</em>, which are measured variables that are relevant to
the overall concept of the composite indicator.</p>
<div class="section level3">
<h3 id="indicator-data">Indicator data<a class="anchor" aria-label="anchor" href="#indicator-data"></a>
</h3>
<p>The first data frame, <code>iData</code> specifies the value of each
indicator, for each unit. It can also contain further attributes and
metadata of units, for example groups, names, and denominating variables
(variables which are used to adjust for size effects of indicators).</p>
<p>To see an example of what <code>iData</code> looks like, we can look
at the built in <a href="https://composite-indicators.jrc.ec.europa.eu/asem-sustainable-connectivity/" class="external-link">ASEM</a>
data set. This data set is from a composite indicator covering 51
countries with 49 indicators, and is used for examples throughout
COINr:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ASEM_iData</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      uName uCode GDP_group GDPpc_group Pop_group EurAsia_group Time   Area</span></span>
<span><span class="co">#&gt; 1  Austria   AUT         L          XL         M        Europe 2018  83871</span></span>
<span><span class="co">#&gt; 2  Belgium   BEL         L           L         L        Europe 2018  30528</span></span>
<span><span class="co">#&gt; 3 Bulgaria   BGR         S           S         M        Europe 2018 110879</span></span>
<span><span class="co">#&gt; 4  Croatia   HRV         S           M         S        Europe 2018  56594</span></span>
<span><span class="co">#&gt; 5   Cyprus   CYP         S           L         S        Europe 2018   9251</span></span>
<span><span class="co">#&gt;   Energy       GDP Population      LPI  Flights      Ship Bord       Elec</span></span>
<span><span class="co">#&gt; 1  27.00 390.79999   8735.453 4.097985 29.01725  0.000000   35 35.3697298</span></span>
<span><span class="co">#&gt; 2  41.83 467.95527  11429.336 4.108538 31.88546 20.567121   48 26.5330467</span></span>
<span><span class="co">#&gt; 3   9.96  53.23964   7084.571 2.807685  9.23588  7.919366   18 11.2775842</span></span>
<span><span class="co">#&gt; 4   7.01  51.23100   4189.353 3.160829  9.24529 12.440452   41 19.5283620</span></span>
<span><span class="co">#&gt; 5   1.43  20.04623   1179.551 2.999061  8.75467 11.689495    0  0.4393643</span></span>
<span><span class="co">#&gt;      Gas ConSpeed Cov4G     Goods</span></span>
<span><span class="co">#&gt; 1  0.273     14.1 98.00 278.42640</span></span>
<span><span class="co">#&gt; 2 36.100     16.3 99.89 597.87230</span></span>
<span><span class="co">#&gt; 3  0.312     15.5 56.73  42.82515</span></span>
<span><span class="co">#&gt; 4  0.422      8.6 98.00  28.36795</span></span>
<span><span class="co">#&gt; 5  0.029      6.9 60.00   8.76681</span></span></code></pre></div>
<p>Here only a few rows and columns are shown to illustrate. The ASEM
data covers covering 51 Asian and European countries, at the national
level, and uses 49 indicators. Notice that each row is an observation
(here, a country), and each column is a variable (mostly indicators, but
also other things).</p>
<p>Columns can be named whatever you want, although a few names are
reserved:</p>
<ul>
<li>
<code>uName</code> [optional] gives the name of each unit. Here,
units are countries, so these are the names of each country.</li>
<li>
<code>uCode</code> [<strong>required</strong>] is a unique code
assigned to each unit (country). This is the main “reference” inside
COINr for units. If the units are countries, ISO Alpha-3 codes should
ideally be used, because these are recognised by COINr for generating
maps.</li>
<li>
<code>Time</code> [optional] gives the reference time of the data.
This is used if panel data is passed to <code><a href="../reference/new_coin.html">new_coin()</a></code>. See <a href="#purses-and-panel-data">Purses and panel data</a>.</li>
</ul>
<p>This means that at a minimum, you need to supply a data frame with a
<code>uCode</code> column, and some indicator columns.</p>
<p>Aside from the reserved names above, columns can be assigned to
different uses using the corresponding <code>iMeta</code> data frame -
this is clarified in the next section.</p>
<p>Some important rules and tips to keep in mind are:</p>
<ul>
<li>Columns don’t have to be in any particular order; they are
identified by names rather than positions.</li>
<li>Indicator columns are required to be numeric, i.e. they cannot be
character vectors.</li>
<li>There is no restriction on the number of indicators and units.</li>
<li>Indicator codes and unit codes must have unique names.</li>
<li>As with everything in R, all codes are case-sensitive.</li>
<li>Don’t start any column names with a number!</li>
</ul>
<p>The <code>iData</code> data frame will be checked when it is passed
to <code><a href="../reference/new_coin.html">new_coin()</a></code>. You can also perform this check yourself in
advance by calling <code><a href="../reference/check_iData.html">check_iData()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_iData.html">check_iData</a></span><span class="op">(</span><span class="va">ASEM_iData</span><span class="op">)</span></span>
<span><span class="co">#&gt; iData checked and OK.</span></span></code></pre></div>
<p>If there are issues with your <code>iData</code> data frame this
should produce informative error messages which can help to correct the
problem.</p>
</div>
<div class="section level3">
<h3 id="indicator-metadata">Indicator metadata<a class="anchor" aria-label="anchor" href="#indicator-metadata"></a>
</h3>
<p>The <code>iMeta</code> data frame specifies everything about each
column in <code>iData</code>, including whether it is an indicator, a
group, or something else; its name, its units, and where it appears in
the <em>structure</em> of the index. <code>iMeta</code> also requires
entries for any aggregates which will be created by aggregating
indicators. Let’s look at the built-in example.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ASEM_iMeta</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Level   iCode                                    iName Direction Weight</span></span>
<span><span class="co">#&gt; 1     1     LPI              Logistics Performance Index         1      1</span></span>
<span><span class="co">#&gt; 2     1 Flights International flights passenger capacity         1      1</span></span>
<span><span class="co">#&gt; 3     1    Ship        Liner Shipping Connectivity Index         1      1</span></span>
<span><span class="co">#&gt; 4     1    Bord                         Border crossings         1      1</span></span>
<span><span class="co">#&gt; 5     1    Elec                     Trade in electricity         1      1</span></span>
<span><span class="co">#&gt;                  Unit     Target Denominator   Parent      Type</span></span>
<span><span class="co">#&gt; 1           Score 1-5   4.118031        &lt;NA&gt; Physical Indicator</span></span>
<span><span class="co">#&gt; 2      Thousand seats 200.332655  Population Physical Indicator</span></span>
<span><span class="co">#&gt; 3               Score  20.113377        &lt;NA&gt; Physical Indicator</span></span>
<span><span class="co">#&gt; 4 Number of crossings 115.900000        Area Physical Indicator</span></span>
<span><span class="co">#&gt; 5                 TWh 104.670585      Energy Physical Indicator</span></span></code></pre></div>
<p>Required columns for <code>iMeta</code> are:</p>
<ul>
<li>
<code>Level</code>: The level in aggregation, where 1 is indicator
level, 2 is the level resulting from aggregating indicators, 3 is the
result of aggregating level 2, and so on. Set to <code>NA</code> for
entries that are not included in the index (groups, denominators,
etc).</li>
<li>
<code>iCode</code>: Indicator code, alphanumeric. Must not start
with a number. These entries generally correspond to the column names of
<code>iData</code>.</li>
<li>
<code>Parent</code>: Group (<code>iCode</code>) to which
indicator/aggregate belongs in level immediately above. Each entry here
should also be found in <code>iCode</code>. Set to <code>NA</code> only
for the highest (Index) level (no parent), or for entries that are not
included in the index (groups, denominators, etc).</li>
<li>
<code>Direction</code>: Numeric, either -1 or 1</li>
<li>
<code>Weight</code>: Numeric weight, will be re-scaled to sum to 1
within aggregation group. Set to <code>NA</code> for entries that are
not included in the index (groups, denominators, etc).</li>
<li>
<code>Type</code>: The type, corresponding to <code>iCode</code>.
Can be either <code>Indicator</code>, <code>Aggregate</code>,
<code>Group</code>, <code>Denominator</code>, or
<code>Other</code>.</li>
</ul>
<p>Optional columns that are recognised in certain functions are:</p>
<ul>
<li>
<code>iName</code>: Name of the indicator: a longer name which is
used in some plotting functions.</li>
<li>
<code>Denominator</code>: specifies which denominator variable
should be used to denominate the indicator, if <code><a href="../reference/Denominate.html">Denominate()</a></code>
is called. See the <a href="denomination.html">Denomination</a>
vignette.</li>
<li>
<code>Unit</code>: the unit of the indicator, e.g. USD, thousands,
score, etc. Used in some plots if available.</li>
<li>
<code>Target</code>: a target for the indicator. Used if
normalisation type is distance-to-target.</li>
</ul>
<p><code>iMeta</code> can also include other columns if needed for
specific uses, as long as they don’t use the names listed above.</p>
<p>The <code>iMeta</code> data frame essentially gives details about
each of the columns found in <code>iData</code>, as well as details
about additional data columns eventually created by aggregating
indicators. This means that the entries in <code>iMeta</code> must
include <em>all</em> columns in <code>iData</code>, <em>except</em> the
three “special” column names: <code>uCode</code>, <code>uName</code>,
and <code>Time</code>. In other words, all column names of
<code>iData</code> should appear in <code>iMeta$iCode</code>, except the
three special cases mentioned.</p>
<p>The <code>Type</code> column specifies the type of the entry:
<code>Indicator</code> should be used for indicators at level 1.
<code>Aggregate</code> for aggregates created by aggregating indicators
or other aggregates. Otherwise set to <code>Group</code> if the variable
is not used for building the index but instead is for defining groups of
units. Set to <code>Denominator</code> if the variable is to be used for
scaling (denominating) other indicators. Finally, set to
<code>Other</code> if the variable should be ignored but passed through.
Any other entries here will cause an error.</p>
<p>Apart from the indicator entries shown above, we can see aggregate
entries:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ASEM_iMeta</span><span class="op">[</span><span class="va">ASEM_iMeta</span><span class="op">$</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"Aggregate"</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;    Level     iCode                        iName Direction Weight  Unit Target</span></span>
<span><span class="co">#&gt; 50     2  Physical                     Physical         1      1 Score     NA</span></span>
<span><span class="co">#&gt; 51     2  ConEcFin Economic and Financial (Con)         1      1 Score     NA</span></span>
<span><span class="co">#&gt; 52     2 Political                    Political         1      1 Score     NA</span></span>
<span><span class="co">#&gt; 53     2    Instit                Institutional         1      1 Score     NA</span></span>
<span><span class="co">#&gt; 54     2       P2P             People to People         1      1 Score     NA</span></span>
<span><span class="co">#&gt; 55     2   Environ                Environmental         1      1 Score     NA</span></span>
<span><span class="co">#&gt; 56     2    Social                       Social         1      1 Score     NA</span></span>
<span><span class="co">#&gt; 57     2  SusEcFin Economic and Financial (Sus)         1      1 Score     NA</span></span>
<span><span class="co">#&gt; 58     3      Conn                 Connectivity         1      1 Score     NA</span></span>
<span><span class="co">#&gt; 59     3      Sust               Sustainability         1      1 Score     NA</span></span>
<span><span class="co">#&gt; 60     4     Index     Sustainable Connectivity         1      1 Score     NA</span></span>
<span><span class="co">#&gt;    Denominator Parent      Type</span></span>
<span><span class="co">#&gt; 50        &lt;NA&gt;   Conn Aggregate</span></span>
<span><span class="co">#&gt; 51        &lt;NA&gt;   Conn Aggregate</span></span>
<span><span class="co">#&gt; 52        &lt;NA&gt;   Conn Aggregate</span></span>
<span><span class="co">#&gt; 53        &lt;NA&gt;   Conn Aggregate</span></span>
<span><span class="co">#&gt; 54        &lt;NA&gt;   Conn Aggregate</span></span>
<span><span class="co">#&gt; 55        &lt;NA&gt;   Sust Aggregate</span></span>
<span><span class="co">#&gt; 56        &lt;NA&gt;   Sust Aggregate</span></span>
<span><span class="co">#&gt; 57        &lt;NA&gt;   Sust Aggregate</span></span>
<span><span class="co">#&gt; 58        &lt;NA&gt;  Index Aggregate</span></span>
<span><span class="co">#&gt; 59        &lt;NA&gt;  Index Aggregate</span></span>
<span><span class="co">#&gt; 60        &lt;NA&gt;   &lt;NA&gt; Aggregate</span></span></code></pre></div>
<p>These are the aggregates that will be created by aggregating
indicators. These values will only be created when we call the
<code><a href="../reference/Aggregate.html">Aggregate()</a></code> function (see relevant vignette). We also have
groups:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ASEM_iMeta</span><span class="op">[</span><span class="va">ASEM_iMeta</span><span class="op">$</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"Group"</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;    Level         iCode                iName Direction Weight Unit Target</span></span>
<span><span class="co">#&gt; 61    NA     GDP_group            GDP group        NA     NA &lt;NA&gt;     NA</span></span>
<span><span class="co">#&gt; 62    NA   GDPpc_group GDP per capita group        NA     NA &lt;NA&gt;     NA</span></span>
<span><span class="co">#&gt; 63    NA     Pop_group     Population group        NA     NA &lt;NA&gt;     NA</span></span>
<span><span class="co">#&gt; 64    NA EurAsia_group       Europe or Asia        NA     NA &lt;NA&gt;     NA</span></span>
<span><span class="co">#&gt;    Denominator Parent  Type</span></span>
<span><span class="co">#&gt; 61        &lt;NA&gt;   &lt;NA&gt; Group</span></span>
<span><span class="co">#&gt; 62        &lt;NA&gt;   &lt;NA&gt; Group</span></span>
<span><span class="co">#&gt; 63        &lt;NA&gt;   &lt;NA&gt; Group</span></span>
<span><span class="co">#&gt; 64        &lt;NA&gt;   &lt;NA&gt; Group</span></span></code></pre></div>
<p>Notice that the <code>iCode</code> entries here correspond to column
names of <code>iData</code>. There are also denominators:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ASEM_iMeta</span><span class="op">[</span><span class="va">ASEM_iMeta</span><span class="op">$</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"Denominator"</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;    Level      iCode              iName Direction Weight               Unit</span></span>
<span><span class="co">#&gt; 65    NA       Area          Land area        NA     NA Thousand square km</span></span>
<span><span class="co">#&gt; 66    NA     Energy Energy consumption        NA     NA               Unit</span></span>
<span><span class="co">#&gt; 67    NA        GDP                GDP        NA     NA             USD Bn</span></span>
<span><span class="co">#&gt; 68    NA Population         Population        NA     NA          Thousands</span></span>
<span><span class="co">#&gt;    Target Denominator Parent        Type</span></span>
<span><span class="co">#&gt; 65     NA        &lt;NA&gt;   &lt;NA&gt; Denominator</span></span>
<span><span class="co">#&gt; 66     NA        &lt;NA&gt;   &lt;NA&gt; Denominator</span></span>
<span><span class="co">#&gt; 67     NA        &lt;NA&gt;   &lt;NA&gt; Denominator</span></span>
<span><span class="co">#&gt; 68     NA        &lt;NA&gt;   &lt;NA&gt; Denominator</span></span></code></pre></div>
<p>Denominators are used to divide or “scale” other indicators. They are
ideally included in <code>iData</code> because this ensures that they
match the units and possibly the time points.</p>
<p>The <code>Parent</code> column requires a few extra words. This is
used to define the structure of the index. Simply put, it specifies the
aggregation group to which the indicator or aggregate belongs to, in the
level immediately above. For indicators in level 1, this should refer to
<code>iCode</code>s in level 2, and for aggregates in level 2, it should
refer to <code>iCode</code>s in level 3. Every entry in
<code>Parent</code> must refer to an entry that can be found in the
<code>iCode</code> column, or else be <code>NA</code> for the highest
aggregation level or for groups, denominators and other
<code>iData</code> columns that are not included in the index.</p>
<p>The <code>iMeta</code> data frame is more complex that
<code>iData</code> and it may be easy to make errors. Use the
<code><a href="../reference/check_iMeta.html">check_iMeta()</a></code> function (which is anyway called by
<code><a href="../reference/new_coin.html">new_coin()</a></code>) to check the validity of your
<code>iMeta</code>. Informative error messages are included where
possible to help correct any errors.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_iMeta.html">check_iMeta</a></span><span class="op">(</span><span class="va">ASEM_iMeta</span><span class="op">)</span></span>
<span><span class="co">#&gt; iMeta checked and OK.</span></span></code></pre></div>
<p>When <code><a href="../reference/new_coin.html">new_coin()</a></code> is run, additional cross-checks are run
between <code>iData</code> and <code>iMeta</code>.</p>
</div>
<div class="section level3">
<h3 id="building-with-new_coin">Building with <code>new_coin()</code><a class="anchor" aria-label="anchor" href="#building-with-new_coin"></a>
</h3>
<p>With the <code>iData</code> and <code>iMeta</code> data frames
prepared, you can build a coin using the <code><a href="../reference/new_coin.html">new_coin()</a></code>
function. This has some other arguments and options that we will see in
a minute, but by default it looks like this:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># build a new coin using example data</span></span>
<span><span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_coin.html">new_coin</a></span><span class="op">(</span>iData <span class="op">=</span> <span class="va">ASEM_iData</span>,</span>
<span>                 iMeta <span class="op">=</span> <span class="va">ASEM_iMeta</span>,</span>
<span>                 level_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Indicator"</span>, <span class="st">"Pillar"</span>, <span class="st">"Sub-index"</span>, <span class="st">"Index"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; iData checked and OK.</span></span>
<span><span class="co">#&gt; iMeta checked and OK.</span></span>
<span><span class="co">#&gt; Written data set to .$Data$Raw</span></span></code></pre></div>
<p>The <code><a href="../reference/new_coin.html">new_coin()</a></code> function checks and cross-checks both
input data frames, and outputs a coin-class object. It also tells us
that it has written a data set to <code>.$Data$Raw</code> - this is the
sub-list that contains the various data sets that will be created each
time we run a coin-building function.</p>
<p>We can see a summary of the coin by calling the coin print method -
this is done simply by calling the name of the coin at the command line,
or equivalently <code>print(coin)</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coin</span></span>
<span><span class="co">#&gt; --------------</span></span>
<span><span class="co">#&gt; A coin with...</span></span>
<span><span class="co">#&gt; --------------</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt;   Units: 51 (AUS, AUT, BEL, ...)</span></span>
<span><span class="co">#&gt;   Indicators: 49 (Goods, Services, FDI, ...)</span></span>
<span><span class="co">#&gt;   Denominators: 4 (Area, Energy, GDP, ...)</span></span>
<span><span class="co">#&gt;   Groups: 4 (GDP_group, GDPpc_group, Pop_group, ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Structure:</span></span>
<span><span class="co">#&gt;   Level 1 Indicator: 49 indicators (FDI, ForPort, Goods, ...) </span></span>
<span><span class="co">#&gt;   Level 2 Pillar: 8 groups (ConEcFin, Instit, P2P, ...) </span></span>
<span><span class="co">#&gt;   Level 3 Sub-index: 2 groups (Conn, Sust) </span></span>
<span><span class="co">#&gt;   Level 4 Index: 1 groups (Index) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data sets:</span></span>
<span><span class="co">#&gt;   Raw (51 units)</span></span></code></pre></div>
<p>This tells us some details about the coin - the number of units,
indicators, denominators and groups; the structure of the index (notice
that the <code>level_names</code> argument is used to describe each
level), and the data sets present in the coin. Currently this only
consists of the “Raw” data set, which is the data set that is created by
default when we run <code><a href="../reference/new_coin.html">new_coin()</a></code>, and simply consists of the
indicator data plus the <code>uCode</code> column. Indeed, we can
retrieve any data set from within a coin at any time using the
<code><a href="../reference/get_dset.html">get_dset()</a></code> function:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first few cols and rows of Raw data set</span></span>
<span><span class="va">data_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dset.html">get_dset</a></span><span class="op">(</span><span class="va">coin</span>, <span class="st">"Raw"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_raw</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;    uCode      LPI  Flights      Ship Bord</span></span>
<span><span class="co">#&gt; 31   AUS 3.793385 36.05498 14.004198    0</span></span>
<span><span class="co">#&gt; 1    AUT 4.097985 29.01725  0.000000   35</span></span>
<span><span class="co">#&gt; 2    BEL 4.108538 31.88546 20.567121   48</span></span>
<span><span class="co">#&gt; 32   BGD 2.663902  4.27955  9.698165   16</span></span>
<span><span class="co">#&gt; 3    BGR 2.807685  9.23588  7.919366   18</span></span></code></pre></div>
<p>By default, calling <code><a href="../reference/get_dset.html">get_dset()</a></code> returns only the unit
code plus the indicator/aggregate columns. We can also attach other
columns such as groups and names by using the <code>also_get</code>
argument. This can be used to attach any of the <code>iData</code>
“metadata” columns that were originally passed when calling
<code><a href="../reference/new_coin.html">new_coin()</a></code>, such as groups, etc.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_dset.html">get_dset</a></span><span class="op">(</span><span class="va">coin</span>, <span class="st">"Raw"</span>, also_get <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"uName"</span>, <span class="st">"Pop_group"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   uCode      uName Pop_group      LPI  Flights</span></span>
<span><span class="co">#&gt; 1   AUS  Australia         L 3.793385 36.05498</span></span>
<span><span class="co">#&gt; 2   AUT    Austria         M 4.097985 29.01725</span></span>
<span><span class="co">#&gt; 3   BEL    Belgium         L 4.108538 31.88546</span></span>
<span><span class="co">#&gt; 4   BGD Bangladesh        XL 2.663902  4.27955</span></span>
<span><span class="co">#&gt; 5   BGR   Bulgaria         M 2.807685  9.23588</span></span></code></pre></div>
<p>Apart from the <code>level_names</code> argument,
<code><a href="../reference/new_coin.html">new_coin()</a></code> also gives the possibility to only pass forward
a subset of the indicators in <code>iMeta</code>. This is done using the
<code>exclude</code> argument, which is useful when testing alternative
sets of indicators - see vignette on adjustments and comparisons.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># exclude two indicators</span></span>
<span><span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_coin.html">new_coin</a></span><span class="op">(</span>iData <span class="op">=</span> <span class="va">ASEM_iData</span>,</span>
<span>                 iMeta <span class="op">=</span> <span class="va">ASEM_iMeta</span>,</span>
<span>                 level_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Indicator"</span>, <span class="st">"Pillar"</span>, <span class="st">"Sub-index"</span>, <span class="st">"Index"</span><span class="op">)</span>,</span>
<span>                 exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LPI"</span>, <span class="st">"Flights"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; iData checked and OK.</span></span>
<span><span class="co">#&gt; iMeta checked and OK.</span></span>
<span><span class="co">#&gt; Written data set to .$Data$Raw</span></span>
<span></span>
<span><span class="va">coin</span></span>
<span><span class="co">#&gt; --------------</span></span>
<span><span class="co">#&gt; A coin with...</span></span>
<span><span class="co">#&gt; --------------</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt;   Units: 51 (AUS, AUT, BEL, ...)</span></span>
<span><span class="co">#&gt;   Indicators: 47 (Goods, Services, FDI, ...)</span></span>
<span><span class="co">#&gt;   Denominators: 4 (Area, Energy, GDP, ...)</span></span>
<span><span class="co">#&gt;   Groups: 4 (GDP_group, GDPpc_group, Pop_group, ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Structure:</span></span>
<span><span class="co">#&gt;   Level 1 Indicator: 47 indicators (FDI, ForPort, Goods, ...) </span></span>
<span><span class="co">#&gt;   Level 2 Pillar: 8 groups (ConEcFin, Instit, P2P, ...) </span></span>
<span><span class="co">#&gt;   Level 3 Sub-index: 2 groups (Conn, Sust) </span></span>
<span><span class="co">#&gt;   Level 4 Index: 1 groups (Index) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data sets:</span></span>
<span><span class="co">#&gt;   Raw (51 units)</span></span></code></pre></div>
<p>Here, <code><a href="../reference/new_coin.html">new_coin()</a></code> has removed the indicator columns from
<code>iData</code> and the corresponding entries in <code>iMeta</code>.
However, the full original <code>iData</code> and <code>iMeta</code>
tables are still stored in the coin.</p>
<p>The <code><a href="../reference/new_coin.html">new_coin()</a></code> function includes a thorough series of
checks on its input arguments which may cause some initial errors while
the format is corrected. The objective is that if you can successfully
assemble a coin, this should work smoothly for all COINr functions.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-coin">Example coin<a class="anchor" aria-label="anchor" href="#example-coin"></a>
</h2>
<p>COINr includes a built in example coin which is constructed using a
function <code><a href="../reference/build_example_coin.html">build_example_coin()</a></code>. This can be useful for
learning how the package works, testing and is used in COINr
documentation extensively because many functions require a coin as an
input. Here we build the example coin (which is again from the ASEM data
set built into COINr) and inspect its contents:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ASEM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_example_coin.html">build_example_coin</a></span><span class="op">(</span>quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ASEM</span></span>
<span><span class="co">#&gt; --------------</span></span>
<span><span class="co">#&gt; A coin with...</span></span>
<span><span class="co">#&gt; --------------</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt;   Units: 51 (AUS, AUT, BEL, ...)</span></span>
<span><span class="co">#&gt;   Indicators: 49 (Goods, Services, FDI, ...)</span></span>
<span><span class="co">#&gt;   Denominators: 4 (Area, Energy, GDP, ...)</span></span>
<span><span class="co">#&gt;   Groups: 4 (GDP_group, GDPpc_group, Pop_group, ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Structure:</span></span>
<span><span class="co">#&gt;   Level 1 Indicator: 49 indicators (FDI, ForPort, Goods, ...) </span></span>
<span><span class="co">#&gt;   Level 2 Pillar: 8 groups (ConEcFin, Instit, P2P, ...) </span></span>
<span><span class="co">#&gt;   Level 3 Sub-index: 2 groups (Conn, Sust) </span></span>
<span><span class="co">#&gt;   Level 4 Index: 1 groups (Index) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data sets:</span></span>
<span><span class="co">#&gt;   Raw (51 units)</span></span>
<span><span class="co">#&gt;   Denominated (51 units)</span></span>
<span><span class="co">#&gt;   Imputed (51 units)</span></span>
<span><span class="co">#&gt;   Screened (51 units)</span></span>
<span><span class="co">#&gt;   Treated (51 units)</span></span>
<span><span class="co">#&gt;   Normalised (51 units)</span></span>
<span><span class="co">#&gt;   Aggregated (51 units)</span></span></code></pre></div>
<p>This shows that the example is a fully populated coin with various
data sets, each resulting from running COINr functions, up to the
aggregation step.</p>
</div>
<div class="section level2">
<h2 id="purses-and-panel-data">Purses and panel data<a class="anchor" aria-label="anchor" href="#purses-and-panel-data"></a>
</h2>
<p>A coin offers a very wide methodological flexibility, but some things
are kept fixed throughout. One is that the set of indicators does not
change once the coin has been created. The other thing is that each coin
represents a single point in time.</p>
<p>If you have panel data, i.e. multiple observations for each
unit-indicator pair, indexed by time, then <code><a href="../reference/new_coin.html">new_coin()</a></code>
allows you to create multiple coins in one go. Coins are collected into
a single object called a “<em>purse</em>”, and many COINr functions work
on purses directly.</p>
<p>Here we simply explore how to create a purse. The procedure is almost
the same as creating a coin: you need the <code>iData</code> and
<code>iMeta</code> data frames, and you call <code><a href="../reference/new_coin.html">new_coin()</a></code>.
The difference is that <code>iData</code> must now have a
<code>Time</code> column, which must be a numeric column which records
which time point each observation is from. To see an example, we can
look at the built-in (artificial) panel data set
<code>ASEM_iData_p</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sample of 2018 observations</span></span>
<span><span class="va">ASEM_iData_p</span><span class="op">[</span><span class="va">ASEM_iData_p</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">2018</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      uName uCode GDP_group GDPpc_group Pop_group EurAsia_group Time   Area</span></span>
<span><span class="co">#&gt; 1  Austria   AUT         L          XL         M        Europe 2018  83871</span></span>
<span><span class="co">#&gt; 2  Belgium   BEL         L           L         L        Europe 2018  30528</span></span>
<span><span class="co">#&gt; 3 Bulgaria   BGR         S           S         M        Europe 2018 110879</span></span>
<span><span class="co">#&gt; 4  Croatia   HRV         S           M         S        Europe 2018  56594</span></span>
<span><span class="co">#&gt; 5   Cyprus   CYP         S           L         S        Europe 2018   9251</span></span>
<span><span class="co">#&gt;   Energy       GDP Population      LPI  Flights      Ship Bord</span></span>
<span><span class="co">#&gt; 1  27.00 390.79999   8735.453 4.097985 29.01725  0.000000   35</span></span>
<span><span class="co">#&gt; 2  41.83 467.95527  11429.336 4.108538 31.88546 20.567121   48</span></span>
<span><span class="co">#&gt; 3   9.96  53.23964   7084.571 2.807685  9.23588  7.919366   18</span></span>
<span><span class="co">#&gt; 4   7.01  51.23100   4189.353 3.160829  9.24529 12.440452   41</span></span>
<span><span class="co">#&gt; 5   1.43  20.04623   1179.551 2.999061  8.75467 11.689495    0</span></span>
<span></span>
<span><span class="co"># sample of 2019 observations</span></span>
<span><span class="va">ASEM_iData_p</span><span class="op">[</span><span class="va">ASEM_iData_p</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">2019</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;       uName uCode GDP_group GDPpc_group Pop_group EurAsia_group Time   Area</span></span>
<span><span class="co">#&gt; 52  Austria   AUT         L          XL         M        Europe 2019  83871</span></span>
<span><span class="co">#&gt; 53  Belgium   BEL         L           L         L        Europe 2019  30528</span></span>
<span><span class="co">#&gt; 54 Bulgaria   BGR         S           S         M        Europe 2019 110879</span></span>
<span><span class="co">#&gt; 55  Croatia   HRV         S           M         S        Europe 2019  56594</span></span>
<span><span class="co">#&gt; 56   Cyprus   CYP         S           L         S        Europe 2019   9251</span></span>
<span><span class="co">#&gt;    Energy       GDP Population      LPI  Flights       Ship      Bord</span></span>
<span><span class="co">#&gt; 52  27.00 390.79999   8735.453 4.153182 37.53763  0.6054851 39.752508</span></span>
<span><span class="co">#&gt; 53  41.83 467.95527  11429.336 4.149371 41.53901 21.2045607 52.123937</span></span>
<span><span class="co">#&gt; 54   9.96  53.23964   7084.571 2.868647 15.82871  7.9467542 23.203648</span></span>
<span><span class="co">#&gt; 55   7.01  51.23100   4189.353 3.230168 16.06586 13.0958316 46.566308</span></span>
<span><span class="co">#&gt; 56   1.43  20.04623   1179.551 3.098577 10.92502 12.3571194  3.993825</span></span></code></pre></div>
<p>This data set has five years of data, spanning 2018-2022 (the data
are artificially generated - at some point I will replace this with a
real example). This means that each row now corresponds to a set of
indicator values for a unit, for a given time point.</p>
<p>To build a purse from this data, we input it into
<code><a href="../reference/new_coin.html">new_coin()</a></code></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># build purse from panel data</span></span>
<span><span class="va">purse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_coin.html">new_coin</a></span><span class="op">(</span>iData <span class="op">=</span> <span class="va">ASEM_iData_p</span>,</span>
<span>                  iMeta <span class="op">=</span> <span class="va">ASEM_iMeta</span>,</span>
<span>                  split_to <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>                  quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Notice here that the <code>iMeta</code> argument is the same as when
we assembled a single coin - this is because a purse is supposed to
consist of coins with the same indicators and structure, i.e. the aim is
to calculate a composite indicator over several points in time, and
generally to apply the same methodology to all coins in the purse. It is
however possible to have different units between coins in the same purse
- this might occur because of data availability differences at different
time points.</p>
<p>The <code>split_to</code> argument should be set to
<code>"all"</code> to create a coin from each time point found in the
data. Alternatively, you can only include a subset of time points by
specifying them as a vector.</p>
<p>A quick way to check the contents of the purse is to call its print
method:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">purse</span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt; A purse with... 5 coins </span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Time n_Units n_Inds n_dsets</span></span>
<span><span class="co">#&gt;  2018      51     49       1</span></span>
<span><span class="co">#&gt;  2019      51     49       1</span></span>
<span><span class="co">#&gt;  2020      51     49       1</span></span>
<span><span class="co">#&gt;  2021      51     49       1</span></span>
<span><span class="co">#&gt;  2022      51     49       1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------</span></span>
<span><span class="co">#&gt; Sample from first coin (2018):</span></span>
<span><span class="co">#&gt; -----------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt;   Units: 51 (AUS, AUT, BEL, ...)</span></span>
<span><span class="co">#&gt;   Indicators: 49 (Goods, Services, FDI, ...)</span></span>
<span><span class="co">#&gt;   Denominators: 4 (Area, Energy, GDP, ...)</span></span>
<span><span class="co">#&gt;   Groups: 4 (GDP_group, GDPpc_group, Pop_group, ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Structure:</span></span>
<span><span class="co">#&gt;   Level 1 : 49 indicators (FDI, ForPort, Goods, ...) </span></span>
<span><span class="co">#&gt;   Level 2 : 8 groups (ConEcFin, Instit, P2P, ...) </span></span>
<span><span class="co">#&gt;   Level 3 : 2 groups (Conn, Sust) </span></span>
<span><span class="co">#&gt;   Level 4 : 1 groups (Index) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data sets:</span></span>
<span><span class="co">#&gt;   Raw (51 units)</span></span></code></pre></div>
<p>This tells us how many coins there are, the number of indicators and
units, and gives some structural information from one of the coins.</p>
<p>A purse is an S3 class object like a coin. In fact, it is simply a
data frame with a <code>Time</code> column and a <code>coin</code>
column, where entries in the <code>coin</code> column are coin objects
(in a so-called “list column”). This is convenient to work with, but if
you try to view it in R Studio, for example, it can be a little
messy.</p>
<p>As with coins, the purse class also has a function in COINr which
produces an example purse:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ASEM_purse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_example_purse.html">build_example_purse</a></span><span class="op">(</span>quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ASEM_purse</span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt; A purse with... 5 coins </span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Time n_Units n_Inds n_dsets</span></span>
<span><span class="co">#&gt;  2018      51     49       5</span></span>
<span><span class="co">#&gt;  2019      51     49       5</span></span>
<span><span class="co">#&gt;  2020      51     49       5</span></span>
<span><span class="co">#&gt;  2021      51     49       5</span></span>
<span><span class="co">#&gt;  2022      51     49       5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------</span></span>
<span><span class="co">#&gt; Sample from first coin (2018):</span></span>
<span><span class="co">#&gt; -----------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt;   Units: 51 (AUS, AUT, BEL, ...)</span></span>
<span><span class="co">#&gt;   Indicators: 49 (Goods, Services, FDI, ...)</span></span>
<span><span class="co">#&gt;   Denominators: 4 (Area, Energy, GDP, ...)</span></span>
<span><span class="co">#&gt;   Groups: 4 (GDP_group, GDPpc_group, Pop_group, ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Structure:</span></span>
<span><span class="co">#&gt;   Level 1 Indicator: 49 indicators (FDI, ForPort, Goods, ...) </span></span>
<span><span class="co">#&gt;   Level 2 Pillar: 8 groups (ConEcFin, Instit, P2P, ...) </span></span>
<span><span class="co">#&gt;   Level 3 Sub-index: 2 groups (Conn, Sust) </span></span>
<span><span class="co">#&gt;   Level 4 Index: 1 groups (Index) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data sets:</span></span>
<span><span class="co">#&gt;   Raw (51 units)</span></span>
<span><span class="co">#&gt;   Screened (46 units)</span></span>
<span><span class="co">#&gt;   Treated (46 units)</span></span>
<span><span class="co">#&gt;   Normalised (46 units)</span></span>
<span><span class="co">#&gt;   Aggregated (46 units)</span></span></code></pre></div>
<p>The purse class can be used directly with COINr functions - this
allows to impute/normalise/treat/aggregate all coins with a single
command, for example.</p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>COINr is mostly designed to work with coins and purses. However, many
key functions also have methods for data frames or vectors. This means
that COINr can either be used as an “ecosystem” of functions built
around coins and purses, or else can just be used as a toolbox for doing
your own work with data frames and other objects.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="http://www.willbecker.me" class="external-link">William Becker</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
