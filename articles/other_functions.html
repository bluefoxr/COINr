<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Other Functions • COINr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Other Functions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">COINr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/overview.html">Overview</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/v1.html">v1.0 updates</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-guides">
<li><h6 class="dropdown-header" data-toc-skip>Construction</h6></li>
    <li><a class="dropdown-item" href="../articles/coins.html">Building coins</a></li>
    <li><a class="dropdown-item" href="../articles/imputation.html">Imputation of missing data</a></li>
    <li><a class="dropdown-item" href="../articles/denomination.html">Denomination</a></li>
    <li><a class="dropdown-item" href="../articles/screening.html">Unit screening</a></li>
    <li><a class="dropdown-item" href="../articles/treat.html">Outlier treatment</a></li>
    <li><a class="dropdown-item" href="../articles/normalise.html">Normalisation</a></li>
    <li><a class="dropdown-item" href="../articles/weights.html">Weighting</a></li>
    <li><a class="dropdown-item" href="../articles/aggregate.html">Aggregation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Post-processing</h6></li>
    <li><a class="dropdown-item" href="../articles/visualisation.html">Visualisation</a></li>
    <li><a class="dropdown-item" href="../articles/analysis.html">Statistical analysis</a></li>
    <li><a class="dropdown-item" href="../articles/results.html">Presenting results</a></li>
    <li><a class="dropdown-item" href="../articles/adjustments.html">Adjustments and comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity.html">Sensitivity analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other</h6></li>
    <li><a class="dropdown-item" href="../articles/data_selection.html">Data selection</a></li>
    <li><a class="dropdown-item" href="../articles/other_functions.html">Other functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bluefoxr/COINr/"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Other Functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bluefoxr/COINr/blob/master/vignettes/other_functions.Rmd" class="external-link"><code>vignettes/other_functions.Rmd</code></a></small>
      <div class="d-none name"><code>other_functions.Rmd</code></div>
    </div>

    
    
<p>This vignette covers other functions that don’t fit in other
vignettes, but still seem useful. Mainly this involves import and
export, and some helper functions.</p>
<div class="section level2">
<h2 id="import-and-export">Import and export<a class="anchor" aria-label="anchor" href="#import-and-export"></a>
</h2>
<p>One of the most useful functions is <code><a href="../reference/export_to_excel.html">export_to_excel()</a></code>.
This can be used to export the contents of a coin to Excel at at any
point in its construction, and is very simple to run. We first build the
example coin:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bluefoxr.github.io/COINr/">COINr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># build example coin</span></span>
<span><span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_example_coin.html">build_example_coin</a></span><span class="op">(</span>quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Then export to Excel:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># export coin to Excel</span></span>
<span><span class="fu"><a href="../reference/export_to_excel.html">export_to_excel</a></span><span class="op">(</span><span class="va">coin</span>, fname <span class="op">=</span> <span class="st">"example_coin_results.xlsx"</span><span class="op">)</span></span></code></pre></div>
<p>This exports every data frame in the coin to a separate tab in the
workbook, named according to its position in the coin. By default it
excludes the Log of the coin, but this can be optionally included. The
function is very useful for passing the results to people who don’t use
R (let’s face it, that’s most people).</p>
<p>Data can also be imported directly into COINr from the <a href="https://knowledge4policy.ec.europa.eu/composite-indicators/coin-tool_en" class="external-link">COIN
Tool</a> which is an Excel-based tool for building and analysing
composite indicators, similar in fact to COINr<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Full disclosure, I was also involved in the development
of the COIN Tool&lt;/p&gt;"><sup>1</sup></a>. With the
<code><a href="../reference/import_COIN_tool.html">import_coin_tool()</a></code> function you can import data directly
from the COIN Tool to cross check or extend your analysis in COINr.</p>
<p>To demonstrate, we can take the example version of the COIN Tool,
which you can download <a href="https://composite-indicators.jrc.ec.europa.eu/sites/default/files/COIN_Tool_v1_LITE_exampledata.xlsm" class="external-link">here</a>.
Then it’s as simple as running:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make sure file is in working directory!</span></span>
<span><span class="va">coin_import</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_COIN_tool.html">import_coin_tool</a></span><span class="op">(</span><span class="st">"COIN_Tool_v1_LITE_exampledata.xlsm"</span>,</span>
<span>                                makecodes <span class="op">=</span> <span class="cn">TRUE</span>, out2 <span class="op">=</span> <span class="st">"coin"</span><span class="op">)</span></span></code></pre></div>
<p>This will directly generate a coin from the COIN Tool.</p>
</div>
<div class="section level2">
<h2 id="converting-from-older-coinr-versions">Converting from older COINr versions<a class="anchor" aria-label="anchor" href="#converting-from-older-coinr-versions"></a>
</h2>
<p>COINr changed drastically from v0.6 to v1.0. So drastically that I
skipped several version numbers. From v1.0, the main object of COINr is
called a “coin” and this is different from the “COIN” used up to v0.6.x.
If you have worked in COINr before v1.0, you can use the
<code><a href="../reference/COIN_to_coin.html">COIN_to_coin()</a></code> function to convert old COINs into new
coins:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/COIN_to_coin.html">COIN_to_coin</a></span><span class="op">(</span><span class="va">COIN</span><span class="op">)</span></span></code></pre></div>
<p>This comes with some limitations: any data sets present in the coin
will not be passed on unless <code>recover_dsets = TRUE</code>. However,
if this is specified, the coin cannot be regenerated because it is not
possible to translate the log from the older COIN class (called the
“Method”) to the log in the new coin class. Still, the conversion avoids
having to reformat <code>iData</code> and <code>iMeta</code>.</p>
</div>
<div class="section level2">
<h2 id="other-useful-functions">Other useful functions<a class="anchor" aria-label="anchor" href="#other-useful-functions"></a>
</h2>
<p>Here we list some accessory functions that could be useful in some
circumstances.</p>
<p>The <code><a href="../reference/rank_df.html">rank_df()</a></code> function converts a data frame to ranks,
ignoring non-numeric columns. Taking some sample data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">ASEM_iData</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">10</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt;   uCode       GDP Population      LPI</span></span>
<span><span class="co">#&gt; 1   AUT 390.79999   8735.453 4.097985</span></span>
<span><span class="co">#&gt; 2   BEL 467.95527  11429.336 4.108538</span></span>
<span><span class="co">#&gt; 3   BGR  53.23964   7084.571 2.807685</span></span>
<span><span class="co">#&gt; 4   HRV  51.23100   4189.353 3.160829</span></span>
<span><span class="co">#&gt; 5   CYP  20.04623   1179.551 2.999061</span></span></code></pre></div>
<p>This looks like</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rank_df.html">rank_df</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="co">#&gt;   uCode GDP Population LPI</span></span>
<span><span class="co">#&gt; 1   AUT   2          2   2</span></span>
<span><span class="co">#&gt; 2   BEL   1          1   1</span></span>
<span><span class="co">#&gt; 3   BGR   3          3   5</span></span>
<span><span class="co">#&gt; 4   HRV   4          4   3</span></span>
<span><span class="co">#&gt; 5   CYP   5          5   4</span></span></code></pre></div>
<p>The <code><a href="../reference/replace_df.html">replace_df()</a></code> function replaces values found anywhere
in a data frame with corresponding new values:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/replace_df.html">replace_df</a></span><span class="op">(</span><span class="va">X</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUT"</span>, <span class="st">"BEL"</span><span class="op">)</span>, new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"test1"</span>, <span class="st">"test2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   uCode       GDP Population      LPI</span></span>
<span><span class="co">#&gt; 1 test1 390.79999   8735.453 4.097985</span></span>
<span><span class="co">#&gt; 2 test2 467.95527  11429.336 4.108538</span></span>
<span><span class="co">#&gt; 3   BGR  53.23964   7084.571 2.807685</span></span>
<span><span class="co">#&gt; 4   HRV  51.23100   4189.353 3.160829</span></span>
<span><span class="co">#&gt; 5   CYP  20.04623   1179.551 2.999061</span></span></code></pre></div>
<p>The <code><a href="../reference/round_df.html">round_df()</a></code> rounds to a specified number of decimal
places, ignoring non-numeric columns:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/round_df.html">round_df</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   uCode   GDP Population LPI</span></span>
<span><span class="co">#&gt; 1   AUT 390.8     8735.5 4.1</span></span>
<span><span class="co">#&gt; 2   BEL 468.0    11429.3 4.1</span></span>
<span><span class="co">#&gt; 3   BGR  53.2     7084.6 2.8</span></span>
<span><span class="co">#&gt; 4   HRV  51.2     4189.4 3.2</span></span>
<span><span class="co">#&gt; 5   CYP  20.0     1179.6 3.0</span></span></code></pre></div>
<p>The <code><a href="../reference/signif_df.html">signif_df()</a></code> is equivalent but for a number of
significant figures:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/signif_df.html">signif_df</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   uCode   GDP Population  LPI</span></span>
<span><span class="co">#&gt; 1   AUT 391.0       8740 4.10</span></span>
<span><span class="co">#&gt; 2   BEL 468.0      11400 4.11</span></span>
<span><span class="co">#&gt; 3   BGR  53.2       7080 2.81</span></span>
<span><span class="co">#&gt; 4   HRV  51.2       4190 3.16</span></span>
<span><span class="co">#&gt; 5   CYP  20.0       1180 3.00</span></span></code></pre></div>
<p>Finally, the <code><a href="../reference/compare_df.html">compare_df()</a></code> function gives a detailed
comparison between two similar data frames that are indexed by a
specified column. This function is tailored to compare results in
composite indicators. Say you have a set of results from COINr and want
to cross check against a separate calculation. Often, you end up with a
data frame with the same columns, but possibly in a different order.
Rows could be in a different order but are indexed by an identifier,
here “uCode”. The <code><a href="../reference/compare_df.html">compare_df()</a></code> function gives a detailed
comparison between the two data frames and points out any
differences.</p>
<p>We’ll demonstrate this by copying the example data frame, altering
some values and seeing what happens:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># copy</span></span>
<span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="va">X</span></span>
<span></span>
<span><span class="co"># change three values</span></span>
<span><span class="va">X1</span><span class="op">$</span><span class="va">GDP</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">101</span></span>
<span><span class="va">X1</span><span class="op">$</span><span class="va">Population</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="va">X1</span><span class="op">$</span><span class="va">Population</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">70000</span></span>
<span></span>
<span><span class="co"># reorder</span></span>
<span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="va">X1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">X1</span><span class="op">$</span><span class="va">uCode</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># now compare</span></span>
<span><span class="fu"><a href="../reference/compare_df.html">compare_df</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">X1</span>, matchcol <span class="op">=</span> <span class="st">"uCode"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Same</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Details</span></span>
<span><span class="co">#&gt;       Column TheSame                          Comment NDifferent</span></span>
<span><span class="co">#&gt; 1      uCode    TRUE      Non-numerical and identical          0</span></span>
<span><span class="co">#&gt; 2        GDP   FALSE Numerical and different at 5 sf.          1</span></span>
<span><span class="co">#&gt; 3 Population   FALSE Numerical and different at 5 sf.          2</span></span>
<span><span class="co">#&gt; 4        LPI    TRUE Numerical and identical to 5 sf.          0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Differences</span></span>
<span><span class="co">#&gt; $Differences$GDP</span></span>
<span><span class="co">#&gt;   uCode      df1 df2</span></span>
<span><span class="co">#&gt; 3   BGR 53.23964 101</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Differences$Population</span></span>
<span><span class="co">#&gt;   uCode       df1   df2</span></span>
<span><span class="co">#&gt; 1   AUT  8735.453 10000</span></span>
<span><span class="co">#&gt; 2   BEL 11429.336 70000</span></span></code></pre></div>
<p>The output is a list with several entries. First, it tells us that
the two data frames are not the same. The “Details” data frame lists
each column and says whether it is identical or not, and how many
different points there are. Finally, the “Differences” list has one
entry for each column that differs, and details the value of the point
from the first data frame compared to the value from the second.</p>
<p>From experience, this kind of output can be very helpful in quickly
zooming in on differences between possibly large data frames of results.
It is mainly intended for the use case described above, where the data
frames are known to be similar, are of the same size, but we want to
check for precise differences.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://www.willbecker.me" class="external-link">William Becker</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
